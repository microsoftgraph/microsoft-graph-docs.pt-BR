---
title: Obter acesso em nome de um usuário
description: Para usar o Microsoft Graph para ler e gravar recursos em nome de um usuário, seu aplicativo deve obter um token de acesso do Azure AD e anexar o token às solicitações que ele envia para o Microsoft Graph.
author: jackson-woods
localization_priority: Priority
ms.prod: applications
ms.custom: graphiamtop20
ms.openlocfilehash: dfa698c43a9870f4f3c1521dd565404b319d0f6f
ms.sourcegitcommit: 9bc1652890fe49d7ad5e5b7177c8a682b1759b75
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/30/2021
ms.locfileid: "52100090"
---
# <a name="get-access-on-behalf-of-a-user"></a><span data-ttu-id="0d374-103">Obter acesso em nome de um usuário</span><span class="sxs-lookup"><span data-stu-id="0d374-103">Get access on behalf of a user</span></span>

<span data-ttu-id="0d374-p101">Para usar o Microsoft Graph para ler e gravar recursos em nome de um usuário, seu aplicativo deve obter um token de acesso da plataforma de identidade da Microsoft e anexá-lo às solicitações que ele envia para o Microsoft Graph. O fluxo de autenticação exato que você usará para obter tokens de acesso dependerá do tipo de aplicativo que você está desenvolvendo e se você deseja usar o OpenID Connect para conectar o usuário ao aplicativo. O fluxo de concessão de código de autorização do OAuth 2.0 é um fluxo comum usado por aplicativos nativos e móveis e também por alguns aplicativos Web. Este tópico analisa um exemplo de uso desse fluxo.</span><span class="sxs-lookup"><span data-stu-id="0d374-p101">To use Microsoft Graph to read and write resources on behalf of a user, your app must get an access token from the Microsoft identity platform and attach the token to requests that it sends to Microsoft Graph. The exact authentication flow that you will use to get access tokens will depend on the kind of app you are developing and whether you want to use OpenID Connect to sign the user in to your app. One common flow used by native and mobile apps and also by some Web apps is the OAuth 2.0 authorization code grant flow. This topic  walks through an example using this flow.</span></span>

## <a name="authentication-and-authorization-steps"></a><span data-ttu-id="0d374-108">Etapas de Autenticação e Autorização</span><span class="sxs-lookup"><span data-stu-id="0d374-108">Authentication and Authorization steps</span></span>

<span data-ttu-id="0d374-109">As etapas básicas necessárias para usar o fluxo de concessão de código de autorização do OAuth 2.0 para obter um token de acesso do ponto de extremidade da plataforma de identidade da Microsoft são:</span><span class="sxs-lookup"><span data-stu-id="0d374-109">The basic steps required to use the OAuth 2.0 authorization code grant flow to get an access token from the Microsoft identity platform endpoint are:</span></span>

1. <span data-ttu-id="0d374-110">Registre seu aplicativo com o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="0d374-110">Register your app with Azure AD.</span></span>
2. <span data-ttu-id="0d374-111">Obtenha autorização.</span><span class="sxs-lookup"><span data-stu-id="0d374-111">Get authorization.</span></span>
3. <span data-ttu-id="0d374-112">Obtenha um token de acesso.</span><span class="sxs-lookup"><span data-stu-id="0d374-112">Get an access token.</span></span>
4. <span data-ttu-id="0d374-113">Chame o Microsoft Graph usando o token de acesso.</span><span class="sxs-lookup"><span data-stu-id="0d374-113">Call Microsoft Graph with the access token.</span></span>
5. <span data-ttu-id="0d374-114">Use um token de atualização para obter um novo token de acesso.</span><span class="sxs-lookup"><span data-stu-id="0d374-114">Use a refresh token to get a new access token.</span></span>

## <a name="1-register-your-app"></a><span data-ttu-id="0d374-115">1. Registre seu aplicativo</span><span class="sxs-lookup"><span data-stu-id="0d374-115">1. Register your app</span></span>

<span data-ttu-id="0d374-p102">Para usar o ponto de extremidade da plataforma de identidade da Microsoft, você deve registrar seu aplicativo no [Portal de Registro de Aplicativos](https://go.microsoft.com/fwlink/?linkid=2083908) do Azure. Você pode usar uma conta da Microsoft ou uma conta corporativa ou de estudante para registrar em aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0d374-p102">To use the Microsoft identity platform endpoint, you must register your app using the Azure [app registration portal](https://go.microsoft.com/fwlink/?linkid=2083908). You can use either a Microsoft account or a work or school account to register an app.</span></span>

<span data-ttu-id="0d374-118">Para configurar um aplicativo para usar o fluxo de concessão do código de autorização do OAuth 2.0, salve os seguintes valores quando registrar o aplicativo:</span><span class="sxs-lookup"><span data-stu-id="0d374-118">To configure an app to use the OAuth 2.0 authorization code grant flow, you'll need to save the following values when registering the app:</span></span>

- <span data-ttu-id="0d374-119">A ID do Aplicativo (cliente) atribuída pelo portal de registro do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0d374-119">The Application (client) ID assigned by the app registration portal.</span></span>
- <span data-ttu-id="0d374-p103">Um Segredo de Cliente (aplicativo), uma senha ou um par de chaves públicas/privadas (certificado). Isso não é necessário para aplicativos nativos.</span><span class="sxs-lookup"><span data-stu-id="0d374-p103">A Client (application) Secret, either a password or a public/private key pair (certificate). This is not required for native apps.</span></span>
- <span data-ttu-id="0d374-122">Uma URL de redirecionamento (ou URL de resposta) para seu aplicativo receber respostas do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="0d374-122">A Redirect URI (or reply URL) for your app to receive responses from Azure AD.</span></span>

<span data-ttu-id="0d374-123">Para saber como configurar um aplicativo no portal do Azure, confira [Registrar seu aplicativo](./auth-register-app-v2.md).</span><span class="sxs-lookup"><span data-stu-id="0d374-123">For steps on how to configure an app in the Azure portal, see [Register your app](./auth-register-app-v2.md).</span></span>

## <a name="2-get-authorization"></a><span data-ttu-id="0d374-124">2. Obter autorização</span><span class="sxs-lookup"><span data-stu-id="0d374-124">2. Get authorization</span></span>

<span data-ttu-id="0d374-125">A primeira etapa para obter um token de acesso para muitos fluxos do OpenID Connect e do OAuth 2.0 é redirecionar o usuário para o ponto de extremidade `/authorize` da plataforma de identidade da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="0d374-125">The first step to getting an access token for many OpenID Connect and OAuth 2.0 flows is to redirect the user to the Microsoft identity platform `/authorize` endpoint.</span></span> <span data-ttu-id="0d374-126">O Azure AD conectará o usuário e garantirá seu consentimento para as permissões solicitadas pelo seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0d374-126">Azure AD will sign the user in and ensure their consent for the permissions your app requests.</span></span> <span data-ttu-id="0d374-127">No fluxo de concessão do código de autorização, depois de obter o consentimento, o Azure AD retorna um authorization_code para o aplicativo que pode resgatá-lo no ponto de extremidade `/token` da plataforma de identidade da Microsoft para obter um token de acesso.</span><span class="sxs-lookup"><span data-stu-id="0d374-127">In the authorization code grant flow, after consent is obtained, Azure AD will return an authorization_code to your app that it can redeem at the Microsoft identity platform `/token` endpoint for an access token.</span></span>

### <a name="authorization-request"></a><span data-ttu-id="0d374-128">Solicitação de autorização</span><span class="sxs-lookup"><span data-stu-id="0d374-128">Authorization request</span></span>

<span data-ttu-id="0d374-129">Veja a seguir um exemplo de solicitação para o ponto de extremidade `/authorize`.</span><span class="sxs-lookup"><span data-stu-id="0d374-129">The following shows an example request to the `/authorize` endpoint.</span></span>

<span data-ttu-id="0d374-130">Com o ponto de extremidade da plataforma de identidade da Microsoft, as permissões são solicitadas usando o parâmetro `scope`.</span><span class="sxs-lookup"><span data-stu-id="0d374-130">With the Microsoft identity platform endpoint, permissions are requested using the `scope` parameter.</span></span> <span data-ttu-id="0d374-131">Neste exemplo, as permissões do Microsoft Graph solicitadas são para _User.Read_ e _Mail.Read_, o que permitirá que o aplicativo leia o perfil e o email do usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="0d374-131">In this example, the Microsoft Graph permissions requested are for _User.Read_ and _Mail.Read_, which will allow the app to read the profile and mail of the signed-in user.</span></span> <span data-ttu-id="0d374-132">A permissão de _acesso\_online_ é solicitada para que o aplicativo possa obter um token de atualização que pode ser usado para obter um novo token de acesso quando o atual expirar.</span><span class="sxs-lookup"><span data-stu-id="0d374-132">The _offline\_access_ permission is requested so that the app can get a refresh token, which it can use to get a new access token when the current one expires.</span></span>

```
// Line breaks for legibility only

https://login.microsoftonline.com/{tenant}/oauth2/v2.0/authorize?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&response_type=code
&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&response_mode=query
&scope=offline_access%20user.read%20mail.read
&state=12345
```

| <span data-ttu-id="0d374-133">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="0d374-133">Parameter</span></span>     | <span data-ttu-id="0d374-134">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-134">Required</span></span>    | <span data-ttu-id="0d374-135">Descrição</span><span class="sxs-lookup"><span data-stu-id="0d374-135">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|---------------|-------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0d374-136">locatário</span><span class="sxs-lookup"><span data-stu-id="0d374-136">tenant</span></span>        | <span data-ttu-id="0d374-137">obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-137">required</span></span>    | <span data-ttu-id="0d374-p106">O valor `{tenant}` no caminho da solicitação pode ser usado para controlar quem pode entrar no aplicativo.  Os valores permitidos são `common` para contas da Microsoft e contas corporativas ou de estudante, `organizations` apenas para contas corporativas ou de estudante, `consumers` apenas para contas da Microsoft e identificadores de locatários, como a ID do locatário ou o nome do domínio.  Para obter mais detalhes, confira [Noções básicas de protocolo](/azure/active-directory/develop/active-directory-v2-protocols#endpoints).</span><span class="sxs-lookup"><span data-stu-id="0d374-p106">The `{tenant}` value in the path of the request can be used to control who can sign into the application.  The allowed values are `common` for both Microsoft accounts and work or school accounts, `organizations` for work or school accounts only, `consumers` for Microsoft accounts only, and tenant identifiers such as the tenant ID or domain name.  For more detail, see [protocol basics](/azure/active-directory/develop/active-directory-v2-protocols#endpoints).</span></span> |
| <span data-ttu-id="0d374-141">client_id</span><span class="sxs-lookup"><span data-stu-id="0d374-141">client_id</span></span>     | <span data-ttu-id="0d374-142">obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-142">required</span></span>    | <span data-ttu-id="0d374-143">A ID do Aplicativo atribuída ao seu aplicativo no [portal de registro](https://go.microsoft.com/fwlink/?linkid=2083908).</span><span class="sxs-lookup"><span data-stu-id="0d374-143">The Application ID that the [registration portal](https://go.microsoft.com/fwlink/?linkid=2083908) assigned your app.</span></span>                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="0d374-144">response_type</span><span class="sxs-lookup"><span data-stu-id="0d374-144">response_type</span></span> | <span data-ttu-id="0d374-145">obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-145">required</span></span>    | <span data-ttu-id="0d374-146">Pode incluir `code` para o fluxo do código de autorização.</span><span class="sxs-lookup"><span data-stu-id="0d374-146">Must include `code` for the authorization code flow.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="0d374-147">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="0d374-147">redirect_uri</span></span>  | <span data-ttu-id="0d374-148">recomendado</span><span class="sxs-lookup"><span data-stu-id="0d374-148">recommended</span></span> | <span data-ttu-id="0d374-p107">A redirect_uri de seu aplicativo, onde as respostas de autenticação podem ser enviadas e recebidas pelo seu aplicativo.  Ela deve corresponder exatamente a uma das redirect_uris registradas no portal de registro de aplicativos, exceto que ela deve ser codificada por URL.  Para aplicativos nativos e móveis, você deve usar o valor padrão de `https://login.microsoftonline.com/common/oauth2/nativeclient`.</span><span class="sxs-lookup"><span data-stu-id="0d374-p107">The redirect_uri of your app, where authentication responses can be sent and received by your app.  It must exactly match one of the redirect_uris you registered in the app registration portal, except it must be URL encoded.  For native and mobile apps, you should use the default value of `https://login.microsoftonline.com/common/oauth2/nativeclient`.</span></span>                                                                                                                                       |
| <span data-ttu-id="0d374-152">escopo</span><span class="sxs-lookup"><span data-stu-id="0d374-152">scope</span></span>         | <span data-ttu-id="0d374-153">obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-153">required</span></span>    | <span data-ttu-id="0d374-p108">Uma lista separada por espaços das permissões do Microsoft Graph que você deseja que o usuário concorde. Isso também pode incluir escopos do OpenID.</span><span class="sxs-lookup"><span data-stu-id="0d374-p108">A space-separated list of the Microsoft Graph permissions that you want the user to consent to. This may also include OpenID scopes.</span></span>                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="0d374-156">response_mode</span><span class="sxs-lookup"><span data-stu-id="0d374-156">response_mode</span></span> | <span data-ttu-id="0d374-157">recomendado</span><span class="sxs-lookup"><span data-stu-id="0d374-157">recommended</span></span> | <span data-ttu-id="0d374-p109">Especifica o método que deve ser usado para enviar o token resultante de volta para seu aplicativo.  Pode ser `query` ou `form_post`.</span><span class="sxs-lookup"><span data-stu-id="0d374-p109">Specifies the method that should be used to send the resulting token back to your app.  Can be `query` or `form_post`.</span></span>                                                                                                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="0d374-160">estado</span><span class="sxs-lookup"><span data-stu-id="0d374-160">state</span></span>         | <span data-ttu-id="0d374-161">recomendado</span><span class="sxs-lookup"><span data-stu-id="0d374-161">recommended</span></span> | <span data-ttu-id="0d374-p110">Um valor incluído na solicitação que também será retornado na resposta do token.  Pode ser uma cadeia de caracteres de qualquer conteúdo desejado.  Um valor exclusivo gerado aleatoriamente é tipicamente usado para [impedir ataques de solicitação entre sites forjada](https://tools.ietf.org/html/rfc6749#section-10.12).  O estado também é usado para codificar as informações sobre o estado do usuário no aplicativo antes da solicitação de autenticação ter ocorrido, como a página ou o modo de exibição em que ele estava.</span><span class="sxs-lookup"><span data-stu-id="0d374-p110">A value included in the request that will also be returned in the token response.  It can be a string of any content that you wish.  A randomly generated unique value is typically used for [preventing cross-site request forgery attacks](https://tools.ietf.org/html/rfc6749#section-10.12).  The state is also used to encode information about the user's state in the app before the authentication request occurred, such as the page or view they were on.</span></span>                                     |

> <span data-ttu-id="0d374-p111">**Importante**: O Microsoft Graph expõe dois tipos de permissões: delegada e de aplicativo. No caso de aplicativos que são executados com um usuário conectado, solicite Permissões Delegadas no parâmetro `scope`. Essas permissões delegam os privilégios do usuário conectado ao seu aplicativo, permitindo que ele atue como o usuário conectado ao fazer chamadas para o Microsoft Graph. Para obter mais informações sobre as permissões disponíveis por meio do Microsoft Graph, confira a [Referência de permissões](./permissions-reference.md).</span><span class="sxs-lookup"><span data-stu-id="0d374-p111">**Important**: Microsoft Graph exposes two kinds of permissions: application and delegated. For apps that run with a signed-in user, you request delegated permissions in the `scope` parameter. These permissions delegate the privileges of the signed-in user to your app, allowing it to act as the signed-in user when making calls to Microsoft Graph. For more detailed information about the permissions available through Microsoft Graph, see the [Permissions reference](./permissions-reference.md).</span></span>

### <a name="consent-experience"></a><span data-ttu-id="0d374-170">Experiência de consentimento</span><span class="sxs-lookup"><span data-stu-id="0d374-170">Consent experience</span></span>

<span data-ttu-id="0d374-171">Neste ponto, o usuário será solicitado a digitar suas credenciais para autenticar usando a Microsoft.</span><span class="sxs-lookup"><span data-stu-id="0d374-171">At this point, the user will be asked to enter their credentials to authenticate with Microsoft.</span></span> <span data-ttu-id="0d374-172">O ponto de extremidade v2.0 da plataforma de identidade da Microsoft também assegurará que o usuário concordou com as permissões indicadas no parâmetro de consulta `scope`.</span><span class="sxs-lookup"><span data-stu-id="0d374-172">The Microsoft identity platform v2.0 endpoint will also ensure that the user has consented to the permissions indicated in the `scope` query parameter.</span></span>  <span data-ttu-id="0d374-173">Se o usuário não tiver concordado com nenhuma dessas permissões e se um administrador não tiver concordado previamente em nome de todos os usuários na organização, será solicitado aos usuários que autorizem as permissões necessárias.</span><span class="sxs-lookup"><span data-stu-id="0d374-173">If the user has not consented to any of those permissions and if an administrator has not previously consented on behalf of all users in the organization, they will be asked to consent to the required permissions.</span></span>

<span data-ttu-id="0d374-174">O exemplo a seguir mostra a caixa de diálogo de consentimento apresentada para uma conta de usuário da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="0d374-174">The following is an example of the consent dialog box presented for a Microsoft account user.</span></span>

![Caixa de diálogo de consentimento da conta da Microsoft](./images/v2-consumer-consent.png)

> <span data-ttu-id="0d374-p113">**Experimente** Se você tiver uma conta da Microsoft ou uma conta corporativa ou de estudante do Azure, experimente clicando no link a seguir. Depois de entrar, seu navegador deverá ser redirecionado para `https://localhost/myapp/` com um `code` na barra de endereços.</span><span class="sxs-lookup"><span data-stu-id="0d374-p113">**Try** If you have a Microsoft account or an Azure AD work or school account, you can try this for yourself by clicking the following link. After signing in, your browser should be redirected to `https://localhost/myapp/` with a `code` in the address bar.</span></span>
>
> <span data-ttu-id="0d374-178"><a href="https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=6731de76-14a6-49ae-97bc-6eba6914391e&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F&response_mode=query&scope=offline_access%20user.read%20mail.read&state=12345" target="_blank">https://login.microsoftonline.com/common/oauth2/v2.0/authorize...</a></span><span class="sxs-lookup"><span data-stu-id="0d374-178"><a href="https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=6731de76-14a6-49ae-97bc-6eba6914391e&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F&response_mode=query&scope=offline_access%20user.read%20mail.read&state=12345" target="_blank">https://login.microsoftonline.com/common/oauth2/v2.0/authorize...</a></span></span>

### <a name="authorization-response"></a><span data-ttu-id="0d374-179">Resposta da autorização</span><span class="sxs-lookup"><span data-stu-id="0d374-179">Authorization response</span></span>

<span data-ttu-id="0d374-p114">Se o usuário concordar com as permissões que seu aplicativo solicitou, a resposta conterá o código de autorização no parâmetro `code`. Veja um exemplo de uma resposta à solicitação anterior. Como o parâmetro `response_mode` na solicitação foi definido como `query`, a resposta é retornada na cadeia de caracteres da consulta da URL de redirecionamento.</span><span class="sxs-lookup"><span data-stu-id="0d374-p114">If the user consents to the permissions your app requested, the response will contain the authorization code in the `code` parameter. Here is an example of a successful response to the previous request. Because the `response_mode` parameter in the request was set to `query`, the response is returned in the query string of the redirect URL.</span></span>

```
GET https://localhost/myapp/?
code=M0ab92efe-b6fd-df08-87dc-2c6500a7f84d
&state=12345
```

| <span data-ttu-id="0d374-183">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="0d374-183">Parameter</span></span> | <span data-ttu-id="0d374-184">Descrição</span><span class="sxs-lookup"><span data-stu-id="0d374-184">Description</span></span>                                                                                                                                                                                                                        |
|-----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0d374-185">código</span><span class="sxs-lookup"><span data-stu-id="0d374-185">code</span></span>      | <span data-ttu-id="0d374-p115">O authorization_code que o aplicativo solicitou. O aplicativo pode usar o código de autorização para solicitar um token de acesso para o recurso de destino.  Os authorization_codes têm períodos de duração muito curtos, geralmente eles expiram após cerca de 10 minutos.</span><span class="sxs-lookup"><span data-stu-id="0d374-p115">The authorization_code that the app requested. The app can use the authorization code to request an access token for the target resource.  Authorization_codes are very short lived, typically they expire after about 10 minutes.</span></span> |
| <span data-ttu-id="0d374-189">estado</span><span class="sxs-lookup"><span data-stu-id="0d374-189">state</span></span>     | <span data-ttu-id="0d374-p116">Se um parâmetro de estado estiver incluído na solicitação, o mesmo valor deverá aparecer na resposta. O aplicativo deve verificar se os valores de estado na solicitação e na resposta são idênticos.</span><span class="sxs-lookup"><span data-stu-id="0d374-p116">If a state parameter is included in the request, the same value should appear in the response. The app should verify that the state values in the request and response are identical.</span></span>                                              |

## <a name="3-get-a-token"></a><span data-ttu-id="0d374-192">3. Obtenha um token</span><span class="sxs-lookup"><span data-stu-id="0d374-192">3. Get a token</span></span>

<span data-ttu-id="0d374-193">Seu aplicativo usa a autorização `code` recebida na etapa anterior para solicitar um token de acesso enviando uma solicitação `POST` para o ponto de extremidade `/token`.</span><span class="sxs-lookup"><span data-stu-id="0d374-193">Your app uses the authorization `code` received in the previous step to request an access token by sending a `POST` request to the `/token` endpoint.</span></span>

### <a name="token-request"></a><span data-ttu-id="0d374-194">Solicitação de token</span><span class="sxs-lookup"><span data-stu-id="0d374-194">Token request</span></span>

```
// Line breaks for legibility only

POST /{tenant}/oauth2/v2.0/token HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&scope=user.read%20mail.read
&code=OAAABAAAAiL9Kn2Z27UubvWFPbm0gLWQJVzCTE9UkP3pSx1aXxUjq3n8b2JRLk4OxVXr...
&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&grant_type=authorization_code
&client_secret=JqQX2PNo9bpM0uEihUPzyrh    // NOTE: Only required for web apps
```

| <span data-ttu-id="0d374-195">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="0d374-195">Parameter</span></span>     | <span data-ttu-id="0d374-196">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-196">Required</span></span>              | <span data-ttu-id="0d374-197">Descrição</span><span class="sxs-lookup"><span data-stu-id="0d374-197">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|---------------|-----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0d374-198">locatário</span><span class="sxs-lookup"><span data-stu-id="0d374-198">tenant</span></span>        | <span data-ttu-id="0d374-199">obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-199">required</span></span>              | <span data-ttu-id="0d374-p117">O valor `{tenant}` no caminho da solicitação pode ser usado para controlar quem pode entrar no aplicativo.  Os valores permitidos são `common` para contas da Microsoft e contas corporativas ou de estudante, `organizations` apenas para contas corporativas ou de estudante, `consumers` apenas para contas da Microsoft e identificadores de locatários, como a ID do locatário ou o nome do domínio.  Para obter mais detalhes, confira [Noções básicas de protocolo](/azure/active-directory/develop/active-directory-v2-protocols#endpoints).</span><span class="sxs-lookup"><span data-stu-id="0d374-p117">The `{tenant}` value in the path of the request can be used to control who can sign into the application.  The allowed values are `common` for both Microsoft accounts and work or school accounts, `organizations` for work or school accounts only, `consumers` for Microsoft accounts only, and tenant identifiers such as the tenant ID or domain name.  For more detail, see [protocol basics](/azure/active-directory/develop/active-directory-v2-protocols#endpoints).</span></span> |
| <span data-ttu-id="0d374-203">client_id</span><span class="sxs-lookup"><span data-stu-id="0d374-203">client_id</span></span>     | <span data-ttu-id="0d374-204">obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-204">required</span></span>              | <span data-ttu-id="0d374-205">A ID do Aplicativo atribuída ao seu aplicativo no [portal de registro)](https://go.microsoft.com/fwlink/?linkid=2083908).</span><span class="sxs-lookup"><span data-stu-id="0d374-205">The Application ID that the [registration portal](https://go.microsoft.com/fwlink/?linkid=2083908)) assigned your app.</span></span>                                                                                                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="0d374-206">grant_type</span><span class="sxs-lookup"><span data-stu-id="0d374-206">grant_type</span></span>    | <span data-ttu-id="0d374-207">obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-207">required</span></span>              | <span data-ttu-id="0d374-208">Deve ser `authorization_code` para o fluxo de código de autorização.</span><span class="sxs-lookup"><span data-stu-id="0d374-208">Must be `authorization_code` for the authorization code flow.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="0d374-209">escopo</span><span class="sxs-lookup"><span data-stu-id="0d374-209">scope</span></span>         | <span data-ttu-id="0d374-210">obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-210">required</span></span>              | <span data-ttu-id="0d374-p118">Uma lista de escopos separada por espaços.  Os escopos solicitados nesta etapa devem ser equivalentes ou ser um subconjunto dos escopos solicitados na primeira etapa (autorização).  Se os escopos especificados nesta solicitação abrangerem vários servidores de recursos, o ponto de extremidade v2.0 retornará um token para o recurso especificado no primeiro escopo.</span><span class="sxs-lookup"><span data-stu-id="0d374-p118">A space-separated list of scopes.  The scopes requested in this leg must be equivalent to or a subset of the scopes requested in the first (authorization) leg.  If the scopes specified in this request span multiple resource servers, then the v2.0 endpoint will return a token for the resource specified in the first scope.</span></span>                                                                                                                                                                      |
| <span data-ttu-id="0d374-214">código</span><span class="sxs-lookup"><span data-stu-id="0d374-214">code</span></span>          | <span data-ttu-id="0d374-215">obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-215">required</span></span>              | <span data-ttu-id="0d374-216">O authorization_code adquirido na primeira etapa do fluxo.</span><span class="sxs-lookup"><span data-stu-id="0d374-216">The authorization_code that you acquired in the first leg of the flow.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="0d374-217">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="0d374-217">redirect_uri</span></span>  | <span data-ttu-id="0d374-218">obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-218">required</span></span>              | <span data-ttu-id="0d374-219">O mesmo valor do redirect_uri que foi usado para adquirir o authorization_code.</span><span class="sxs-lookup"><span data-stu-id="0d374-219">The same redirect_uri value that was used to acquire the authorization_code.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="0d374-220">client_secret</span><span class="sxs-lookup"><span data-stu-id="0d374-220">client_secret</span></span> | <span data-ttu-id="0d374-221">obrigatório para aplicativos Web</span><span class="sxs-lookup"><span data-stu-id="0d374-221">required for web apps</span></span> | <span data-ttu-id="0d374-p119">O segredo do aplicativo que você criou no portal de registro de aplicativos para seu aplicativo.  Ele não deve ser usado em um aplicativo nativo já que a permissão client_secrets não pode ser confiavelmente armazenada em dispositivos.  É obrigatório para aplicativos Web e APIs da Web que têm a capacidade de armazenar a permissão client_secret em segurança no lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="0d374-p119">The application secret that you created in the app registration portal for your app.  It should not be used in a native app, because client_secrets cannot be reliably stored on devices.  It is required for web apps and web APIs, which have the ability to store the client_secret securely on the server side.</span></span>                                                                                                                                                                                     |

### <a name="token-response"></a><span data-ttu-id="0d374-225">Resposta do token</span><span class="sxs-lookup"><span data-stu-id="0d374-225">Token response</span></span>

<span data-ttu-id="0d374-226">Embora o token de acesso seja opaco para o aplicativo, a resposta contém uma lista das permissões para as quais o token de acesso servirá no parâmetro `scope`.</span><span class="sxs-lookup"><span data-stu-id="0d374-226">Although the access token is opaque to your app, the response contains a list of the permissions that the access token is good for in the `scope` parameter.</span></span>

```json
{
    "token_type": "Bearer",
    "scope": "user.read%20Fmail.read",
    "expires_in": 3600,
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...",
    "refresh_token": "AwABAAAAvPM1KaPlrEqdFSBzjqfTGAMxZGUTdM0t4B4..."
}
```

| <span data-ttu-id="0d374-227">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="0d374-227">Parameter</span></span>     | <span data-ttu-id="0d374-228">Descrição</span><span class="sxs-lookup"><span data-stu-id="0d374-228">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                  |
|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0d374-229">token_type</span><span class="sxs-lookup"><span data-stu-id="0d374-229">token_type</span></span>    | <span data-ttu-id="0d374-p120">Indica o valor de tipo de token. O único tipo a que o Azure AD dá suporte é o token de portador.</span><span class="sxs-lookup"><span data-stu-id="0d374-p120">Indicates the token type value. The only type that Azure AD supports is Bearer.</span></span>                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="0d374-232">scope</span><span class="sxs-lookup"><span data-stu-id="0d374-232">scope</span></span>         | <span data-ttu-id="0d374-233">Uma lista separada por espaços das permissões do Microsoft Graph para as quais o access_token é válido.</span><span class="sxs-lookup"><span data-stu-id="0d374-233">A space separated list of the Microsoft Graph permissions that the access_token is valid for.</span></span>                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="0d374-234">expires_in</span><span class="sxs-lookup"><span data-stu-id="0d374-234">expires_in</span></span>    | <span data-ttu-id="0d374-235">Por quanto tempo o token de acesso é válido (em segundos).</span><span class="sxs-lookup"><span data-stu-id="0d374-235">How long the access token is valid (in seconds).</span></span>                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="0d374-236">access_token</span><span class="sxs-lookup"><span data-stu-id="0d374-236">access_token</span></span>  | <span data-ttu-id="0d374-p121">O token de acesso solicitado. Seu aplicativo pode usar esse token para chamar o Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="0d374-p121">The requested access token. Your app can use this token to call Microsoft Graph.</span></span>                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="0d374-239">refresh_token</span><span class="sxs-lookup"><span data-stu-id="0d374-239">refresh_token</span></span> | <span data-ttu-id="0d374-240">Um token de atualização OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="0d374-240">An OAuth 2.0 refresh token.</span></span> <span data-ttu-id="0d374-241">Seu aplicativo poderá usar este token para adquirir tokens de acesso adicionais depois que o token de acesso atual expirar.</span><span class="sxs-lookup"><span data-stu-id="0d374-241">Your app can use this token to acquire additional access tokens after the current access token expires.</span></span>  <span data-ttu-id="0d374-242">Os tokens de atualização são de longa duração e podem ser usados para manter o acesso aos recursos por longos períodos de tempo.</span><span class="sxs-lookup"><span data-stu-id="0d374-242">Refresh tokens are long-lived, and can be used to retain access to resources for extended periods of time.</span></span>  <span data-ttu-id="0d374-243">Confira mais detalhes na [referência de token v2.0](/azure/active-directory/develop/active-directory-v2-tokens).</span><span class="sxs-lookup"><span data-stu-id="0d374-243">For more detail, refer to the [v2.0 token reference](/azure/active-directory/develop/active-directory-v2-tokens).</span></span> |

## <a name="4-use-the-access-token-to-call-microsoft-graph"></a><span data-ttu-id="0d374-244">4. Use o token de acesso para chamar o Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="0d374-244">4. Use the access token to call Microsoft Graph</span></span>

<span data-ttu-id="0d374-p123">Após obter o token de acesso, você pode usá-lo para chamar o Microsoft Graph, incluindo-o no cabeçalho `Authorization` de uma solicitação. A solicitação a seguir obtém o perfil do usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="0d374-p123">After you have an access token, you can use it to call Microsoft Graph by including it in the `Authorization` header of a request. The following request gets the profile of the signed-in user.</span></span>

```
GET https://graph.microsoft.com/v1.0/me
Authorization: Bearer eyJ0eXAiO ... 0X2tnSQLEANnSPHY0gKcgw
Host: graph.microsoft.com

```

<span data-ttu-id="0d374-247">Uma resposta bem-sucedida terá a seguinte aparência (alguns cabeçalhos de resposta foram removidos).</span><span class="sxs-lookup"><span data-stu-id="0d374-247">A successful response will look similar to the following (some response headers have been removed).</span></span>

```
HTTP/1.1 200 OK
Content-Type: application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8
request-id: f45d08c0-6901-473a-90f5-7867287de97f
client-request-id: f45d08c0-6901-473a-90f5-7867287de97f
OData-Version: 4.0
Duration: 727.0022
Date: Thu, 20 Apr 2017 05:21:18 GMT
Content-Length: 407

{
    "@odata.context":"https://graph.microsoft.com/v1.0/$metadata#users/$entity",
    "id":"12345678-73a6-4952-a53a-e9916737ff7f",
    "businessPhones":[
        "+1 555555555"
    ],
    "displayName":"Chris Green",
    "givenName":"Chris",
    "jobTitle":"Software Engineer",
    "mail":null,
    "mobilePhone":"+1 5555555555",
    "officeLocation":"Seattle Office",
    "preferredLanguage":null,
    "surname":"Green",
    "userPrincipalName":"ChrisG@contoso.onmicrosoft.com"
}
```

## <a name="5-use-the-refresh-token-to-get-a-new-access-token"></a><span data-ttu-id="0d374-248">5. Use um token de atualização para obter um novo token de acesso</span><span class="sxs-lookup"><span data-stu-id="0d374-248">5. Use the refresh token to get a new access token</span></span>

<span data-ttu-id="0d374-p124">Os tokens de acesso têm curta duração e você deve atualizá-los após a expiração para continuar acessando os recursos.  Isso pode ser feito enviando outra solicitação `POST` ao ponto de extremidade `/token`, dessa vez fornecendo o `refresh_token` em vez do `code`.</span><span class="sxs-lookup"><span data-stu-id="0d374-p124">Access tokens are short lived, and you must refresh them after they expire to continue accessing resources.  You can do so by submitting another `POST` request to the `/token` endpoint, this time providing the `refresh_token` instead of the `code`.</span></span>

### <a name="request"></a><span data-ttu-id="0d374-251">Solicitação</span><span class="sxs-lookup"><span data-stu-id="0d374-251">Request</span></span>

```
// Line breaks for legibility only

POST /common/oauth2/v2.0/token HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&scope=user.read%20mail.read
&refresh_token=OAAABAAAAiL9Kn2Z27UubvWFPbm0gLWQJVzCTE9UkP3pSx1aXxUjq...
&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&grant_type=refresh_token
&client_secret=JqQX2PNo9bpM0uEihUPzyrh      // NOTE: Only required for web apps
```

| <span data-ttu-id="0d374-252">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="0d374-252">Parameter</span></span>     | <span data-ttu-id="0d374-253">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-253">Required</span></span>              | <span data-ttu-id="0d374-254">Descrição</span><span class="sxs-lookup"><span data-stu-id="0d374-254">Description</span></span>                                                                                                                                                                                                                                                                                                         |
|---------------|-----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0d374-255">client_id</span><span class="sxs-lookup"><span data-stu-id="0d374-255">client_id</span></span>     | <span data-ttu-id="0d374-256">obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-256">required</span></span>              | <span data-ttu-id="0d374-257">A ID do Aplicativo atribuída ao seu aplicativo no [portal de registro](https://go.microsoft.com/fwlink/?linkid=2083908).</span><span class="sxs-lookup"><span data-stu-id="0d374-257">The Application ID that the [registration portal](https://go.microsoft.com/fwlink/?linkid=2083908) assigned your app.</span></span>                                                                                                                                                                                               |
| <span data-ttu-id="0d374-258">grant_type</span><span class="sxs-lookup"><span data-stu-id="0d374-258">grant_type</span></span>    | <span data-ttu-id="0d374-259">obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-259">required</span></span>              | <span data-ttu-id="0d374-260">Deve ser `refresh_token`.</span><span class="sxs-lookup"><span data-stu-id="0d374-260">Must be `refresh_token`.</span></span>                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="0d374-261">escopo</span><span class="sxs-lookup"><span data-stu-id="0d374-261">scope</span></span>         | <span data-ttu-id="0d374-262">obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-262">required</span></span>              | <span data-ttu-id="0d374-p125">Uma lista de permissões (escopos) separada por espaços.  As permissões solicitadas devem ser equivalentes ou ser um subconjunto das permissões solicitadas na solicitação original do authorization_code.</span><span class="sxs-lookup"><span data-stu-id="0d374-p125">A space-separated list of permissions (scopes).  The permissions requested must be equivalent to or a subset of the permissions requested in the original authorization_code request.</span></span>                                                                                                                               |
| <span data-ttu-id="0d374-265">refresh_token</span><span class="sxs-lookup"><span data-stu-id="0d374-265">refresh_token</span></span> | <span data-ttu-id="0d374-266">obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-266">required</span></span>              | <span data-ttu-id="0d374-267">O refresh_token adquirido durante a solicitação do token.</span><span class="sxs-lookup"><span data-stu-id="0d374-267">The refresh_token that you acquired during the token request.</span></span>                                                                                                                                                                                                                                                       |
| <span data-ttu-id="0d374-268">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="0d374-268">redirect_uri</span></span>  | <span data-ttu-id="0d374-269">obrigatório</span><span class="sxs-lookup"><span data-stu-id="0d374-269">required</span></span>              | <span data-ttu-id="0d374-270">O mesmo valor do redirect_uri que foi usado para adquirir o authorization_code.</span><span class="sxs-lookup"><span data-stu-id="0d374-270">The same redirect_uri value that was used to acquire the authorization_code.</span></span>                                                                                                                                                                                                                                        |
| <span data-ttu-id="0d374-271">client_secret</span><span class="sxs-lookup"><span data-stu-id="0d374-271">client_secret</span></span> | <span data-ttu-id="0d374-272">obrigatório para aplicativos Web</span><span class="sxs-lookup"><span data-stu-id="0d374-272">required for web apps</span></span> | <span data-ttu-id="0d374-p126">O segredo do aplicativo que você criou no portal de registro de aplicativos para seu aplicativo.  Ele não deve ser usado em um aplicativo nativo já que a permissão client_secrets não pode ser confiavelmente armazenada em dispositivos.  É obrigatório para aplicativos Web e APIs da Web que têm a capacidade de armazenar a permissão client_secret em segurança no lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="0d374-p126">The application secret that you created in the app registration portal for your app.  It should not be used in a native app, because client_secrets cannot be reliably stored on devices.  It is required for web apps and web APIs, which have the ability to store the client_secret securely on the server side.</span></span> |

### <a name="response"></a><span data-ttu-id="0d374-276">Resposta</span><span class="sxs-lookup"><span data-stu-id="0d374-276">Response</span></span>

<span data-ttu-id="0d374-277">Uma resposta de token bem-sucedida será semelhante ao seguinte.</span><span class="sxs-lookup"><span data-stu-id="0d374-277">A successful token response will look similar to the following.</span></span>

```
{
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...",
    "token_type": "Bearer",
    "expires_in": 3599,
    "scope": "user.read%20mail.read",
    "refresh_token": "AwABAAAAvPM1KaPlrEqdFSBzjqfTGAMxZGUTdM0t4B4...",
}
```
| <span data-ttu-id="0d374-278">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="0d374-278">Parameter</span></span>     | <span data-ttu-id="0d374-279">Descrição</span><span class="sxs-lookup"><span data-stu-id="0d374-279">Description</span></span>                                                                                                                                                                        |
|---------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0d374-280">access_token</span><span class="sxs-lookup"><span data-stu-id="0d374-280">access_token</span></span>  | <span data-ttu-id="0d374-p127">O token de acesso solicitado. O aplicativo pode usar esse token em chamadas para o Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="0d374-p127">The requested access token. The app can use this token in calls to Microsoft Graph.</span></span>                                                                                                |
| <span data-ttu-id="0d374-283">token_type</span><span class="sxs-lookup"><span data-stu-id="0d374-283">token_type</span></span>    | <span data-ttu-id="0d374-p128">Indica o valor de tipo de token. O único tipo a que o Azure AD dá suporte é o token de portador</span><span class="sxs-lookup"><span data-stu-id="0d374-p128">Indicates the token type value. The only type that Azure AD supports is Bearer</span></span>                                                                                                     |
| <span data-ttu-id="0d374-286">expires_in</span><span class="sxs-lookup"><span data-stu-id="0d374-286">expires_in</span></span>    | <span data-ttu-id="0d374-287">Por quanto tempo o token de acesso é válido (em segundos).</span><span class="sxs-lookup"><span data-stu-id="0d374-287">How long the access token is valid (in seconds).</span></span>                                                                                                                                   |
| <span data-ttu-id="0d374-288">escopo</span><span class="sxs-lookup"><span data-stu-id="0d374-288">scope</span></span>         | <span data-ttu-id="0d374-289">As permissões (escopos) para as quais o access_token é válido.</span><span class="sxs-lookup"><span data-stu-id="0d374-289">The permissions (scopes) that the access_token is valid for.</span></span>                                                                                                                       |
| <span data-ttu-id="0d374-290">refresh_token</span><span class="sxs-lookup"><span data-stu-id="0d374-290">refresh_token</span></span> | <span data-ttu-id="0d374-p129">Um novo token de atualização OAuth 2.0. Você deve substituir o token de atualização antigo por este token de atualização recém-adquirido para garantir que seus tokens de atualização permaneçam válidos pelo maior tempo possível.</span><span class="sxs-lookup"><span data-stu-id="0d374-p129">A new OAuth 2.0 refresh token. You should replace the old refresh token with this newly acquired refresh token to ensure your refresh tokens remain valid for as long as possible.</span></span> |

## <a name="supported-app-scenarios-and-additional-resources"></a><span data-ttu-id="0d374-293">Recursos adicionais e cenários de aplicativo com suporte</span><span class="sxs-lookup"><span data-stu-id="0d374-293">Supported app scenarios and additional resources</span></span>

<span data-ttu-id="0d374-294">Você pode chamar o Microsoft Graph em nome de um usuário a partir dos seguintes tipos de aplicativos:</span><span class="sxs-lookup"><span data-stu-id="0d374-294">You can call Microsoft Graph on behalf of a user from the following kinds of apps:</span></span>

- [<span data-ttu-id="0d374-295">Aplicativos Nativos/Móveis</span><span class="sxs-lookup"><span data-stu-id="0d374-295">Native/Mobile apps</span></span>](/azure/active-directory/develop/scenario-mobile-overview)
- [<span data-ttu-id="0d374-296">Aplicativos Web</span><span class="sxs-lookup"><span data-stu-id="0d374-296">Web apps</span></span>](/azure/active-directory/develop/scenario-web-app-call-api-overview)
- [<span data-ttu-id="0d374-297">Aplicativos de página única (SPA)</span><span class="sxs-lookup"><span data-stu-id="0d374-297">Single page apps (SPA)</span></span>](/azure/active-directory/develop/scenario-spa-overview)
- <span data-ttu-id="0d374-298">[Back-end de APIs da Web](/azure/active-directory/develop/scenario-web-app-call-api-overview): por exemplo, em cenários onde um aplicativo de cliente, como um aplicativo nativo, implementa a funcionalidade em um back-end da API da Web.</span><span class="sxs-lookup"><span data-stu-id="0d374-298">[Back-end Web APIs](/azure/active-directory/develop/scenario-web-app-call-api-overview): For example, in scenarios where a client app, like a native app, implements functionality in a Web API back end.</span></span> <span data-ttu-id="0d374-299">Com o ponto de extremidade da plataforma de identidade da Microsoft, tanto o aplicativo de cliente quanto o back-end da API da Web devem ter a mesma ID do Aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0d374-299">With the Microsoft identity platform endpoint, both the client app and the back-end Web API must have the same Application ID.</span></span>

<span data-ttu-id="0d374-300">Para saber mais sobre os cenários de aplicativo compatíveis com o ponto de extremidade da plataforma de identidade da Microsoft, consulte [Cenários de aplicativo e fluxos de autenticação](/azure/active-directory/develop/authentication-flows-app-scenarios).</span><span class="sxs-lookup"><span data-stu-id="0d374-300">For more information about supported app scenarios with the Microsoft identity platform endpoint, see [App scenarios and authentication flows](/azure/active-directory/develop/authentication-flows-app-scenarios).</span></span>

> <span data-ttu-id="0d374-301">**Observação**: chamar o Microsoft Graph a partir de uma API da Web autônoma atualmente não tem suporte do ponto de extremidade da plataforma de identidade da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="0d374-301">**Note**: Calling Microsoft Graph from a standalone web API is not currently supported by the Microsoft identity platform endpoint.</span></span> <span data-ttu-id="0d374-302">Nesse caso, você precisa usar o ponto de extremidade do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="0d374-302">For this scenario, you need to use the Azure AD endpoint.</span></span>

<span data-ttu-id="0d374-303">Para obter mais informações sobre como obter acesso ao Microsoft Graph em nome de um usuário a partir do ponto de extremidade da plataforma de identidade da Microsoft:</span><span class="sxs-lookup"><span data-stu-id="0d374-303">For more information about getting access to Microsoft Graph on behalf of a user from the Microsoft identity platform endpoint:</span></span>

- <span data-ttu-id="0d374-304">Para obter links para documentação de protocolos e artigos de introdução a diferentes tipos de aplicativos, confira a [Documentação do ponto de extremidade da plataforma de identidade da Microsoft](/azure/active-directory/develop/active-directory-appmodel-v2-overview).</span><span class="sxs-lookup"><span data-stu-id="0d374-304">For links to protocol documentation and getting started articles for different kinds of apps, see the [Microsoft identity platform endpoint documentation](/azure/active-directory/develop/active-directory-appmodel-v2-overview).</span></span>
- <span data-ttu-id="0d374-305">Para obter explicações detalhadas sobre os tipos de aplicativo e os fluxos de autenticação compatíveis, confira [tipos de aplicativo v2.0](/azure/active-directory/develop/v2-app-types).</span><span class="sxs-lookup"><span data-stu-id="0d374-305">For detailed explanations of supported application types and authentication flows, see [v2.0 app types](/azure/active-directory/develop/v2-app-types).</span></span>
- <span data-ttu-id="0d374-306">Para obter mais informações sobre o middleware de servidor e bibliotecas de autenticação recomendadas da Microsoft e de terceiros da plataforma de identidade da Microsoft, confira as [bibliotecas de autenticação do Azure Active Directory v2.0](/azure/active-directory/develop/active-directory-v2-libraries).</span><span class="sxs-lookup"><span data-stu-id="0d374-306">For more information about recommended Microsoft and third-party authentication libraries and server middleware for the Microsoft identity platform, see [Azure Active Directory v2.0 authentication libraries](/azure/active-directory/develop/active-directory-v2-libraries).</span></span>

## <a name="endpoint-considerations"></a><span data-ttu-id="0d374-307">Considerações sobre o ponto de extremidade</span><span class="sxs-lookup"><span data-stu-id="0d374-307">Endpoint considerations</span></span>

<span data-ttu-id="0d374-308">A Microsoft continua oferecendo suporte ao ponto de extremidade do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="0d374-308">Microsoft continues to support the Azure AD endpoint.</span></span> <span data-ttu-id="0d374-309">Existem [várias diferenças](/azure/active-directory/develop/azure-ad-endpoint-comparison) entre a utilização do ponto de extremidade da plataforma de identidade da Microsoft e o ponto de extremidade do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="0d374-309">There are [several differences](/azure/active-directory/develop/azure-ad-endpoint-comparison) between using the Microsoft identity platform endpoint and the Azure AD endpoint.</span></span> <span data-ttu-id="0d374-310">Durante o uso do ponto de extremidade do Azure AD:</span><span class="sxs-lookup"><span data-stu-id="0d374-310">When using the Azure AD endpoint:</span></span>

- <span data-ttu-id="0d374-311">O aplicativo exigirá uma ID de aplicativo diferente (ID do cliente) para cada plataforma.</span><span class="sxs-lookup"><span data-stu-id="0d374-311">Your app will require a different application ID (client ID) for each platform.</span></span>
- <span data-ttu-id="0d374-312">Se o aplicativo for um aplicativo multilocatário, você deve configurá-lo explicitamente para funcionar como multilocatário no [portal do Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="0d374-312">If your app is a multi-tenant app, you must explicitly configure it to be multi-tenant at the [Azure portal](https://portal.azure.com).</span></span>
- <span data-ttu-id="0d374-p133">Todas as permissões de que seu aplicativo precisa devem ser configuradas pelo desenvolvedor. O ponto de extremidade do Microsoft Azure Active Directory não oferece suporte ao consentimento dinâmico (incremental).</span><span class="sxs-lookup"><span data-stu-id="0d374-p133">All permissions that your app needs must be configured by the developer. The Azure AD endpoint does not support dynamic (incremental) consent.</span></span>
- <span data-ttu-id="0d374-p134">O ponto de extremidade do Azure AD usa um parâmetro `resource` em solicitações de autorização e de token para especificar o recurso, como o Microsoft Graph, para o qual ele deseja permissões. O ponto de extremidade não é compatível com o parâmetro `scope`.</span><span class="sxs-lookup"><span data-stu-id="0d374-p134">The Azure AD endpoint uses a `resource` parameter in authorization and token requests to specify the resource, such as Microsoft Graph, for which it wants permissions. The endpoint does not support the `scope` parameter.</span></span>
- <span data-ttu-id="0d374-p135">O ponto de extremidade do Azure AD não expõe um ponto de extremidade específico para o consentimento do administrador. Em vez disso, os aplicativos usam o parâmetro `prompt=admin_consent` na solicitação de autorização para obter o consentimento do administrador para uma organização. Para obter mais informações, confira **Como acionar a estrutura do consentimento do Azure AD no tempo de execução** no artigo [Integração de aplicativos com o Azure Active Directory](/azure/active-directory/develop/active-directory-integrating-applications).</span><span class="sxs-lookup"><span data-stu-id="0d374-p135">The Azure AD endpoint does not expose a specific endpoint for administrator consent. Instead apps use the `prompt=admin_consent` parameter in the authorization request to obtain administrator consent for an organization. For more information, see **Triggering the Azure AD consent framework at runtime** in [Integrating applications with Azure Active Directory](/azure/active-directory/develop/active-directory-integrating-applications).</span></span>

<span data-ttu-id="0d374-320">Para obter mais informações sobre como obter acesso ao Microsoft Graph em nome de um usuário a partir do ponto de extremidade do Azure AD:</span><span class="sxs-lookup"><span data-stu-id="0d374-320">For more information about getting access to Microsoft Graph on behalf of a user from the Azure AD endpoint:</span></span>

- <span data-ttu-id="0d374-321">Para saber mais sobre o ponto de extremidade da plataforma de identidade da Microsoft com diferentes tipos de aplicativos, confira os links de **Introdução** na [documentação de desenvolvedor da plataforma de identidade da Microsoft](/azure/active-directory/develop/active-directory-developers-guide).</span><span class="sxs-lookup"><span data-stu-id="0d374-321">For information about using the Microsoft identity platform endpoint with different kinds of apps, see the **Get Started** links in the [Microsoft identity platform developer documentation](/azure/active-directory/develop/active-directory-developers-guide).</span></span> <span data-ttu-id="0d374-322">A documentação contém links para tópicos de visão geral, guias de início rápido, tutoriais, exemplos de código e documentação de protocolo para diferentes tipos de aplicativos compatíveis com o ponto de extremidade da plataforma de identidade da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="0d374-322">The documentation contains links to overview topics, quickstarts, tutorials, code samples and protocol documentation for different kinds of apps supported by the Microsoft identity platform endpoint.</span></span>
- <span data-ttu-id="0d374-323">Para saber mais sobre a MSAL (Biblioteca de Autenticação da Microsoft) e o middleware de servidor disponíveis para uso com o ponto de extremidade da plataforma de identidade da Microsoft, confira [Bibliotecas de Autenticação da Microsoft](/azure/active-directory/develop/msal-overview).</span><span class="sxs-lookup"><span data-stu-id="0d374-323">For information about the Microsoft Authentication Library (MSAL) and server middleware available for use with the Microsoft identity platform endpoint, see [Microsoft Authentication Libraries](/azure/active-directory/develop/msal-overview).</span></span>

## <a name="see-also"></a><span data-ttu-id="0d374-324">Confira também</span><span class="sxs-lookup"><span data-stu-id="0d374-324">See also</span></span>

<span data-ttu-id="0d374-325">Para obter um exemplo de um aplicativo Web hospedado no Serviço de Aplicativo do Azure chamando o Microsoft Graph como o usuário, confira [Tutorial: acesse o Microsoft Graph de um aplicativo seguro como o usuário](/azure/app-service/scenario-secure-app-access-microsoft-graph-as-user).</span><span class="sxs-lookup"><span data-stu-id="0d374-325">For an example of a web app hosted on Azure App Service calling Microsoft Graph as the user, see [Tutorial: Access Microsoft Graph from a secured app as the user](/azure/app-service/scenario-secure-app-access-microsoft-graph-as-user).</span></span> <span data-ttu-id="0d374-326">Aprenda como conceder permissões delegadas a um aplicativo da web, configurar o serviço de aplicativo para obter um token de acesso e chamar o Microsoft Graph de um aplicativo da web para um usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="0d374-326">Learn how to grant delegated permissions to a web app, configure App Service to get an access token, and call Microsoft Graph from a web app for a signed-in user.</span></span>
