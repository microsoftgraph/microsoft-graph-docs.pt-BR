---
title: Usar a consulta delta para controlar alterações nos dados do Microsoft Graph
description: A consulta delta permite que aplicativos localizem entidades recém-criadas, atualizadas ou excluídas sem executar uma leitura completa do recurso de destino com cada solicitação. Os aplicativos do Microsoft Graph podem usar consulta delta para sincronizar, com eficiência, alterações com armazenamento de dados local.
author: davidmu1
localization_priority: Priority
ms.custom: graphiamtop20
ms.openlocfilehash: cceab6a803b403560c6a72831584c99202d65618
ms.sourcegitcommit: 34891a1c601976166958be1aa04bab5936592b44
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/06/2021
ms.locfileid: "52231987"
---
# <a name="use-delta-query-to-track-changes-in-microsoft-graph-data"></a><span data-ttu-id="9b6cb-104">Usar a consulta delta para controlar alterações nos dados do Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="9b6cb-104">Use delta query to track changes in Microsoft Graph data</span></span>

<span data-ttu-id="9b6cb-p102">A consulta delta permite que aplicativos localizem entidades recém-criadas, atualizadas ou excluídas sem executar uma leitura completa do recurso de destino com cada solicitação. Os aplicativos do Microsoft Graph podem usar consulta delta para sincronizar, com eficiência, alterações com armazenamento de dados local.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-p102">Delta query enables applications to discover newly created, updated, or deleted entities without performing a full read of the target resource with every request. Microsoft Graph applications can use delta query to efficiently synchronize changes with a local data store.</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="9b6cb-107">Tutorial: usar notificações de alteração e controlar alterações com o Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="9b6cb-107">Tutorial: Use Change Notifications and Track Changes with Microsoft Graph</span></span>](/learn/modules/msgraph-changenotifications-trackchanges)

## <a name="use-delta-query-to-track-changes-in-a-resource-collection"></a><span data-ttu-id="9b6cb-108">Usar solicitação delta para rastrear alterações em uma coleção resource</span><span class="sxs-lookup"><span data-stu-id="9b6cb-108">Use delta query to track changes in a resource collection</span></span>

<span data-ttu-id="9b6cb-109">O padrão típico de chamada corresponde ao que segue:</span><span class="sxs-lookup"><span data-stu-id="9b6cb-109">The typical call pattern is as follows:</span></span>

1. <span data-ttu-id="9b6cb-110">O aplicativo começa chamando uma solicitação GET com a função delta no recurso desejado.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-110">The application begins by calling a GET request with the delta function on the desired resource.</span></span>
2. <span data-ttu-id="9b6cb-111">O Microsoft Graph envia uma resposta que contém o recurso solicitado e um [token de estado](#state-tokens).</span><span class="sxs-lookup"><span data-stu-id="9b6cb-111">Microsoft Graph sends a response containing the requested resource and a [state token](#state-tokens).</span></span>

     <span data-ttu-id="9b6cb-p103">a.  Se uma URL `nextLink` é retornada, poderá haver páginas de dados adicionais a serem recuperadas na sessão. O aplicativo continua fazendo solicitações usando a URL `nextLink` para recuperar todas as páginas de dados até que uma URL `deltaLink` seja retornada na resposta.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-p103">a.  If a `nextLink` URL is returned, there may be additional pages of data to be retrieved in the session. The application continues making requests using the `nextLink` URL to retrieve all pages of data until a `deltaLink` URL is returned in the response.</span></span>

     <span data-ttu-id="9b6cb-p104">b.  Se uma URL `deltaLink` é retornada, não há mais nenhum dado sobre o estado do recurso a ser retornado. Em solicitações futuras, o aplicativo usa a URL `deltaLink` para inteirar-se das alterações feitas no recurso.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-p104">b.  If a `deltaLink` URL is returned, there is no more data about the existing state of the resource to be returned. For future requests, the application uses the `deltaLink` URL to learn about changes to the resource.</span></span>

3. <span data-ttu-id="9b6cb-p105">Quando o aplicativo precisa saber das alterações no recurso, ele faz uma nova solicitação usando a URL `deltaLink` recebida na etapa 2. Esta solicitação *pode* ser feita imediatamente após concluir a etapa 2 ou quando o aplicativo verifica as alterações.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-p105">When the application needs to learn about changes to the resource, it makes a new request using the `deltaLink` URL received in step 2. This request *may* be made immediately after completing step 2 or when the application checks for changes.</span></span>
4. <span data-ttu-id="9b6cb-120">O Microsoft Graph retorna uma resposta, descrevendo alterações no recurso desde a solicitação anterior e em uma URL `nextLink` ou uma URL `deltaLink`.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-120">Microsoft Graph returns a response describing changes to the resource since the previous request, and either a `nextLink` URL or a `deltaLink` URL.</span></span>

><span data-ttu-id="9b6cb-121">**Observação:** recursos armazenados no Azure Active Directory (por exemplo, usuários e grupos) dão suporte a cenários do tipo "sincronizar a partir de agora".</span><span class="sxs-lookup"><span data-stu-id="9b6cb-121">**Note:** Resources stored in Azure Active Directory (such as users and groups) support "sync from now" scenarios.</span></span> <span data-ttu-id="9b6cb-122">Isso permite que você ignore as etapas 1 e 2 acima (se você não está interessado em recuperar o estado completo do recurso) e peça para conferir o último `deltaLink` em vez disso.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-122">This allows you to skip steps 1 and 2 (if you're not interested in retrieving the full state of the resource) and ask for the latest `deltaLink` instead.</span></span> <span data-ttu-id="9b6cb-123">Acrescente `$deltaToken=latest` à função `delta`, e a resposta conterá um `deltaLink` e nenhum dado do recurso.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-123">Append `$deltaToken=latest` to the `delta` function and the response will contain a `deltaLink` and no resource data.</span></span> <span data-ttu-id="9b6cb-124">Os recursos do OneDrive e do Microsoft Office SharePoint Online também oferecem suporte a esse recurso.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-124">Resources in OneDrive and SharePoint also support this feature.</span></span> <span data-ttu-id="9b6cb-125">Para recursos no OneDrive e no Microsoft Office SharePoint Online, anexe `token=latest` em vez disso.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-125">For resources in OneDrive and SharePoint, append `token=latest` instead.</span></span>

><span data-ttu-id="9b6cb-126">**Observação:** a função de consulta Delta geralmente é referida ao acrescentar `/delta` ao nome do recurso.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-126">**Note:** The delta query function is generally referred to by appending `/delta` to the resource name.</span></span> <span data-ttu-id="9b6cb-127">No entanto, `/delta` é um atalho para o nome totalmente qualificado `/microsoft.graph.delta` que você vê em solicitações geradas pelos SDKs do Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-127">However, `/delta` is a shortcut for the fully qualified name `/microsoft.graph.delta` that you see in requests generated by the Microsoft Graph SDKs.</span></span>

><span data-ttu-id="9b6cb-128">**Observação:** a solicitação inicial para a função de consulta delta (nenhum token delta ou skip) retornará os recursos existentes na coleção.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-128">**Note:** The initial request to the delta query function (no delta or skip token) will return the resources that currently exist in the collection.</span></span> <span data-ttu-id="9b6cb-129">Os recursos que foram criados e excluídos antes da consulta delta inicial não serão retornados.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-129">Resources that have been created and deleted prior to the initial delta query won't be returned.</span></span> <span data-ttu-id="9b6cb-130">As atualizações feitas antes da solicitação inicial são resumidas no recurso retornado como seu estado mais recente.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-130">Updates made before the initial request are summarized on the resource returned as its latest state.</span></span>

### <a name="state-tokens"></a><span data-ttu-id="9b6cb-131">Tokens de estado</span><span class="sxs-lookup"><span data-stu-id="9b6cb-131">State tokens</span></span>

<span data-ttu-id="9b6cb-p109">Um GET de consulta delta sempre inclui uma URL especificada em um cabeçalho de resposta `nextLink` ou `deltaLink`. A URL `nextLink` inclui um _skipToken_ e uma URL `deltaLink` inclui um _deltaToken_.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-p109">A delta query GET response always includes a URL specified in a `nextLink` or `deltaLink` response header. The `nextLink` URL includes a _skipToken_, and a `deltaLink` URL includes a _deltaToken_.</span></span>

<span data-ttu-id="9b6cb-p110">Esses tokens são opacos para o cliente. Os seguintes detalhes são o que você precisa saber sobre eles:</span><span class="sxs-lookup"><span data-stu-id="9b6cb-p110">These tokens are opaque to the client. The following details are what you need to know about them:</span></span>

- <span data-ttu-id="9b6cb-136">Cada token reflete o estado e representa um instantâneo do recurso dessa fase do controle de alterações.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-136">Each token reflects the state and represents a snapshot of the resource in that round of change tracking.</span></span>

- <span data-ttu-id="9b6cb-p111">Os tokens de estado também codificam e incluem outros parâmetros da consulta (como `$select`) especificados na solicitação de consulta delta inicial. Portanto, ele não é necessário repeti-los em solicitações de consulta delta subsequentes.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-p111">The state tokens also encode and include other query parameters (such as `$select`) specified in the initial delta query request. Therefore, it's not required to repeat them in subsequent delta query requests.</span></span>

- <span data-ttu-id="9b6cb-139">Ao realizar a consulta delta, você pode copiar e aplicar a URL `nextLink` ou `deltaLink` à próxima chamada de função **delta** sem precisar inspecionar o conteúdo da URL, incluindo seu token de estado.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-139">When carrying out delta query, you can copy and apply the `nextLink` or `deltaLink` URL to the next **delta** function call without having to inspect the contents of the URL, including its state token.</span></span>

### <a name="optional-query-parameters"></a><span data-ttu-id="9b6cb-140">Parâmetros de consulta opcionais</span><span class="sxs-lookup"><span data-stu-id="9b6cb-140">Optional query parameters</span></span>

<span data-ttu-id="9b6cb-p112">Se um cliente usa um parâmetro de consulta, ele deve ser especificado na solicitação inicial. O Microsoft Graph codifica automaticamente o parâmetro especificado em `nextLink` ou `deltaLink` fornecidos na resposta. O aplicativo de chamada só precisa especificar os parâmetros de consulta desejados uma vez antecipados. O Microsoft Graph adiciona os parâmetros especificados automaticamente para todas as solicitações subsequentes.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-p112">If a client uses a query parameter, it must be specified in the initial request. Microsoft Graph automatically encodes the specified parameter into the `nextLink` or `deltaLink` provided in the response. The calling application only needs to specify the query parameters once upfront. Microsoft Graph adds the specified parameters automatically for all subsequent requests.</span></span>

<span data-ttu-id="9b6cb-145">Observe o suporte geral limitado dos seguintes parâmetros de consulta opcionais:</span><span class="sxs-lookup"><span data-stu-id="9b6cb-145">Note the general limited support of the following optional query parameters:</span></span>

- `$orderby`

    <span data-ttu-id="9b6cb-146">Não assuma que uma sequência específica das respostas tenha retornado de uma consulta delta.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-146">Do not assume a specific sequence of the responses returned from a delta query.</span></span> <span data-ttu-id="9b6cb-147">Suponha que o mesmo item possa aparecer em qualquer lugar na sequência do `nextLink` e leve isso em conta em sua lógica de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-147">Assume that the same item can show up anywhere in the `nextLink` sequence and handle that in your merge logic.</span></span>
- `$top`

    <span data-ttu-id="9b6cb-148">O número de objetos em cada página pode variar dependendo do tipo de recurso e do tipo de alterações feitas no recurso.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-148">The number of objects in each page can vary depending on the resource type and the type of changes made to the resource.</span></span>

<span data-ttu-id="9b6cb-149">Para obter o recurso[mensagem](/graph/api/resources/message?view=graph-rest-1.0), consulte os detalhes do [suporte aos parâmetros de consulta em uma consulta delta](delta-query-messages.md#use-query-parameters-in-a-delta-query-for-messages).</span><span class="sxs-lookup"><span data-stu-id="9b6cb-149">For the [message](/graph/api/resources/message?view=graph-rest-1.0) resource, see details for [query parameters support in a delta query](delta-query-messages.md#use-query-parameters-in-a-delta-query-for-messages).</span></span>

<span data-ttu-id="9b6cb-150">Para os recursos de [usuário](/graph/api/resources/user?view=graph-rest-1.0) e [grupo](/graph/api/resources/group?view=graph-rest-1.0), há restrições no uso de alguns parâmetros de consulta:</span><span class="sxs-lookup"><span data-stu-id="9b6cb-150">For the [user](/graph/api/resources/user?view=graph-rest-1.0) and [group](/graph/api/resources/group?view=graph-rest-1.0) resources, there are restrictions on using some query parameters:</span></span>

- <span data-ttu-id="9b6cb-151">Não há suporte para `$expand`.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-151">`$expand` is not supported.</span></span>
- <span data-ttu-id="9b6cb-152">Não há suporte para `$top`.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-152">`$top` is not supported.</span></span>
- <span data-ttu-id="9b6cb-153">Não há suporte para `$orderby`.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-153">`$orderby` is not supported.</span></span>
- <span data-ttu-id="9b6cb-p114">Se um parâmetro de consulta `$select` for usado, isso indica que o cliente prefere somente controlar alterações nas propriedades ou relações especificadas na instrução `$select`. Se ocorrer uma alteração em uma propriedade que não esteja selecionada, o recurso por meio do qual essa propriedade foi alterada não aparecerá na resposta delta após uma solicitação subsequente.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-p114">If a `$select` query parameter is used, the parameter indicates that the client prefers to only track changes on the properties or relationships specified in the `$select` statement. If a change occurs to a property that is not selected, the resource for which that property changed does not appear in the delta response after a subsequent request.</span></span>
- <span data-ttu-id="9b6cb-156">O `$select` também tem suporte para `manager` e `members` propriedade de navegação para usuários e grupos, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-156">`$select` also supports `manager` and `members` navigational property for users and groups respectively.</span></span> <span data-ttu-id="9b6cb-157">A seleção dessas propriedades permite controlar as alterações feitas no gerenciador de usuário e nas associações de grupo.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-157">Selecting those properties allows tracking of changes to user's manager and group memberships.</span></span>

- <span data-ttu-id="9b6cb-p116">Os filtros de escopo permitem controlar alterações para um ou mais usuários ou grupos específicos por ID de objeto. Por exemplo, a seguinte solicitação retorna alterações para os grupos que correspondem às IDs especificadas no filtro de consulta.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-p116">Scoping filters allow you to track changes to one or more specific users or groups by object ID. For example, the following request returns changes for the groups matching the IDs specified in the query filter.</span></span>

<!-- {
  "blockType": "request",
  "name": "group_delta"
}-->
```http
https://graph.microsoft.com/beta/groups/delta/?$filter=id eq '477e9fc6-5de7-4406-bb2a-7e5c83c9ae5f' or id eq '004d6a07-fe70-4b92-add5-e6e37b8acd8e'
```

## <a name="resource-representation-in-the-delta-query-response"></a><span data-ttu-id="9b6cb-160">Representação de recurso na resposta da consulta delta</span><span class="sxs-lookup"><span data-stu-id="9b6cb-160">Resource representation in the delta query response</span></span>

- <span data-ttu-id="9b6cb-161">Instâncias de um recurso recém-criadas de um recurso para o qual há suporte são representadas na resposta da consulta delta usando sua representação-padrão.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-161">Newly created instances of a supported resource are represented in the delta query response using their standard representation.</span></span>

- <span data-ttu-id="9b6cb-162">Instâncias atualizadas são representadas por seus **id** com *pelo menos* as propriedades que foram atualizadas, mas podem ser incluídas propriedades adicionais.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-162">Updated instances are represented by their **id** with *at least* the properties that have been updated, but additional properties may be included.</span></span>

- <span data-ttu-id="9b6cb-p117">Relações entre os usuários e os grupos são representadas como anotações na representação do recurso padrão. Essas anotações usam o formato `propertyName@delta`. As anotações são incluídas na resposta da solicitação de consulta inicial delta.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-p117">Relationships on users and groups are represented as annotations on the standard resource representation. These annotations use the format `propertyName@delta`. The annotations are included in the response of the initial delta query request.</span></span>

<span data-ttu-id="9b6cb-p118">As instâncias removidas são representadas por sua **id** e um objeto `@removed`. O objeto `@removed` pode incluir informações adicionais sobre o porquê de a instância ter sido removida. Por exemplo, "@removed": {"reason": “changed”}.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-p118">Removed instances are represented by their **id** and an `@removed` object. The `@removed` object may include additional information about why the instance was removed. For example,  "@removed": {"reason": "changed"}.</span></span>

<span data-ttu-id="9b6cb-169">Possíveis motivos @removed podem ser *changed* ou *deleted*.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-169">Possible @removed reasons can be *changed* or *deleted*.</span></span>

- <span data-ttu-id="9b6cb-170">*Alterado* indica que o item foi excluído e poderá ser restaurado de [deletedItems](/graph/api/resources/directory).</span><span class="sxs-lookup"><span data-stu-id="9b6cb-170">*Changed* indicates the item was deleted and can be restored from [deletedItems](/graph/api/resources/directory).</span></span>

- <span data-ttu-id="9b6cb-171">*Deleted* indica que o item foi excluído e não pode ser restaurado.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-171">*Deleted* indicates the item is deleted and cannot be restored.</span></span>

<span data-ttu-id="9b6cb-p119">O objeto `@removed` pode ser retornado na resposta de consulta delta inicial e nas respostas rastreadas (deltaLink). Os clientes que usam solicitações de consulta delta devem ser designados para lidar com esses objetos nas respostas.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-p119">The `@removed` object can be returned in the initial delta query response and in tracked (deltaLink) responses. Clients using delta query requests should be designed to handle these objects in the responses.</span></span>

><span data-ttu-id="9b6cb-174">**Observação:** é possível que uma única entidade seja incluída várias vezes na resposta, caso essa entidade tenha sido alterada várias vezes e sob determinadas condições.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-174">**Note:** It's possible that a single entity will be contained multiple times in the response, if that entity was changed multiple times and under certain conditions.</span></span> <span data-ttu-id="9b6cb-175">As consultas Delta permitem aos aplicativos listar todas as alterações, mas não garantem que as entidades sejam unificadas em uma única resposta.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-175">Delta queries enable your application to list all the changes, but can't ensure that entities are unified in a single response.</span></span>

## <a name="supported-resources"></a><span data-ttu-id="9b6cb-176">Recursos com suporte</span><span class="sxs-lookup"><span data-stu-id="9b6cb-176">Supported resources</span></span>

<span data-ttu-id="9b6cb-177">A consulta delta é compatível atualmente com os seguintes recursos.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-177">Delta query is currently supported for the following resources.</span></span> <span data-ttu-id="9b6cb-178">Observe que alguns recursos que estão disponíveis na versão 1.0 têm suas funções **delta** correspondente ainda em estado de visualização prévia, como indicado.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-178">Note that some resources which are available in v1.0 have their corresponding **delta** functions still in preview status, as indicated.</span></span>

| <span data-ttu-id="9b6cb-179">**Coleção de recursos**</span><span class="sxs-lookup"><span data-stu-id="9b6cb-179">**Resource collection**</span></span>                                        | <span data-ttu-id="9b6cb-180">**API**</span><span class="sxs-lookup"><span data-stu-id="9b6cb-180">**API**</span></span>                                                                                                                                                      |
| :------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <span data-ttu-id="9b6cb-181">Aplicativos</span><span class="sxs-lookup"><span data-stu-id="9b6cb-181">Applications</span></span>                                                   | <span data-ttu-id="9b6cb-182">Função [delta](/graph/api/application-delta) do recurso [aplicativo](/graph/api/resources/application)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-182">[delta](/graph/api/application-delta) function of the [application](/graph/api/resources/application) resource</span></span>                                               |
| <span data-ttu-id="9b6cb-183">Unidades administrativas (visualização)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-183">Administrative units (preview)</span></span>                                 | <span data-ttu-id="9b6cb-184">Função [delta](/graph/api/administrativeunit-delta) (visualização) do recurso [administrativeUnit](/graph/api/resources/administrativeunit)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-184">[delta](/graph/api/administrativeunit-delta) function (preview) of the [administrativeUnit](/graph/api/resources/administrativeunit) resource</span></span>                |
| <span data-ttu-id="9b6cb-185">Mensagens de chat em um canal.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-185">Chat messages in a channel</span></span>                                     | <span data-ttu-id="9b6cb-186">Função [delta](/graph/api/chatmessage-delta) (visualização) do [chatMessage](/graph/api/resources/chatmessage)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-186">[delta](/graph/api/chatmessage-delta) function (preview) of the [chatMessage](/graph/api/resources/chatmessage)</span></span>                                              |
| <span data-ttu-id="9b6cb-187">Objetos de diretório</span><span class="sxs-lookup"><span data-stu-id="9b6cb-187">Directory objects</span></span>                                              | <span data-ttu-id="9b6cb-188">Função [delta](/graph/api/directoryobject-delta) (visualização) do recurso [directoryObjects](/graph/api/resources/directoryobject)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-188">[delta](/graph/api/directoryobject-delta) function (preview) of the [directoryObject](/graph/api/resources/directoryobject) resource</span></span>                         |
| <span data-ttu-id="9b6cb-189">Funções de diretório</span><span class="sxs-lookup"><span data-stu-id="9b6cb-189">Directory roles</span></span>                                                | <span data-ttu-id="9b6cb-190">Função [delta](/graph/api/directoryrole-delta?view=graph-rest-1.0) do recurso [directoryRole](/graph/api/resources/directoryrole?view=graph-rest-1.0)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-190">[delta](/graph/api/directoryrole-delta?view=graph-rest-1.0) function of the [directoryRole](/graph/api/resources/directoryrole?view=graph-rest-1.0) resource</span></span> |
| <span data-ttu-id="9b6cb-191">Itens de unidade\*</span><span class="sxs-lookup"><span data-stu-id="9b6cb-191">Drive items\*</span></span>                                                  | <span data-ttu-id="9b6cb-192">Função [delta](/graph/api/driveitem-delta?view=graph-rest-1.0) do recurso [driveItem](/graph/api/resources/driveitem?view=graph-rest-1.0)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-192">[delta](/graph/api/driveitem-delta?view=graph-rest-1.0) function of the [driveItem](/graph/api/resources/driveitem?view=graph-rest-1.0) resource</span></span>             |
| <span data-ttu-id="9b6cb-193">Salas de Aula da Educação</span><span class="sxs-lookup"><span data-stu-id="9b6cb-193">Education Classes</span></span>                                              | <span data-ttu-id="9b6cb-194">Função [delta](/graph/api/educationclass-delta) do recurso [educationClass](/graph/api/resources/educationclass)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-194">[delta](/graph/api/educationclass-delta) function of the [educationClass](/graph/api/resources/educationclass) resource</span></span>                                      |
| <span data-ttu-id="9b6cb-195">Usuários da Educação</span><span class="sxs-lookup"><span data-stu-id="9b6cb-195">Education Users</span></span>                                                | <span data-ttu-id="9b6cb-196">Função [delta](/graph/api/educationuser-delta) do recurso [educationUser](/graph/api/resources/educationuser)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-196">[delta](/graph/api/educationuser-delta) function of the [educationUser](/graph/api/resources/educationuser) resource</span></span>                                         |
| <span data-ttu-id="9b6cb-197">Escolas da Educação</span><span class="sxs-lookup"><span data-stu-id="9b6cb-197">Education Schools</span></span>                                              | <span data-ttu-id="9b6cb-198">Função [delta](/graph/api/educationschool-delta) do recurso [educationSchool](/graph/api/resources/educationschool)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-198">[delta](/graph/api/educationschool-delta) function of the [educationSchool](/graph/api/resources/educationschool) resource</span></span>                                   |
| <span data-ttu-id="9b6cb-199">Eventos em um modo de exibição de calendário (intervalo de datas) do calendário principal</span><span class="sxs-lookup"><span data-stu-id="9b6cb-199">Events in a calendar view (date range) of the primary calendar</span></span> | <span data-ttu-id="9b6cb-200">função [delta](/graph/api/event-delta?view=graph-rest-1.0) do recurso [evento](/graph/api/resources/event?view=graph-rest-1.0)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-200">[delta](/graph/api/event-delta?view=graph-rest-1.0) function of the [event](/graph/api/resources/event?view=graph-rest-1.0) resource</span></span>                         |
| <span data-ttu-id="9b6cb-201">Grupos</span><span class="sxs-lookup"><span data-stu-id="9b6cb-201">Groups</span></span>                                                         | <span data-ttu-id="9b6cb-202">Função [delta](/graph/api/group-delta?view=graph-rest-1.0) do recurso [group](/graph/api/resources/group?view=graph-rest-1.0)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-202">[delta](/graph/api/group-delta?view=graph-rest-1.0) function of the [group](/graph/api/resources/group?view=graph-rest-1.0) resource</span></span>                         |
| <span data-ttu-id="9b6cb-203">Pastas de email</span><span class="sxs-lookup"><span data-stu-id="9b6cb-203">Mail folders</span></span>                                                   | <span data-ttu-id="9b6cb-204">função [delta](/graph/api/mailfolder-delta?view=graph-rest-1.0) do recurso [mailFolder](/graph/api/resources/mailfolder?view=graph-rest-1.0) </span><span class="sxs-lookup"><span data-stu-id="9b6cb-204">[delta](/graph/api/mailfolder-delta?view=graph-rest-1.0) function of the [mailFolder](/graph/api/resources/mailfolder?view=graph-rest-1.0) resource</span></span>          |
| <span data-ttu-id="9b6cb-205">Mensagens de uma pasta</span><span class="sxs-lookup"><span data-stu-id="9b6cb-205">Messages in a folder</span></span>                                           | <span data-ttu-id="9b6cb-206">função [delta](/graph/api/message-delta?view=graph-rest-1.0) do recurso [mensagem](/graph/api/resources/message?view=graph-rest-1.0) </span><span class="sxs-lookup"><span data-stu-id="9b6cb-206">[delta](/graph/api/message-delta?view=graph-rest-1.0) function of the [message](/graph/api/resources/message?view=graph-rest-1.0) resource</span></span>                   |
| <span data-ttu-id="9b6cb-207">Contatos organizacionais</span><span class="sxs-lookup"><span data-stu-id="9b6cb-207">Organizational contacts</span></span>                                        | <span data-ttu-id="9b6cb-208">função [delta](/graph/api/orgcontact-delta?view=graph-rest-1.0) do recurso [orgContact](/graph/api/resources/orgcontact?view=graph-rest-1.0)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-208">[delta](/graph/api/orgcontact-delta?view=graph-rest-1.0) function of the [orgContact](/graph/api/resources/orgcontact?view=graph-rest-1.0) resource</span></span>          |
| <span data-ttu-id="9b6cb-209">OAuth2PermissionGrants</span><span class="sxs-lookup"><span data-stu-id="9b6cb-209">OAuth2PermissionGrants</span></span>                                         | <span data-ttu-id="9b6cb-210">Função [delta](/graph/api/oauth2permissiongrant-delta) do recurso [oauth2permissiongrant](/graph/api/resources/oauth2permissiongrant) </span><span class="sxs-lookup"><span data-stu-id="9b6cb-210">[delta](/graph/api/oauth2permissiongrant-delta) function of the [oauth2permissiongrant](/graph/api/resources/oauth2permissiongrant) resource</span></span>                 |
| <span data-ttu-id="9b6cb-211">Pastas de contatos pessoais</span><span class="sxs-lookup"><span data-stu-id="9b6cb-211">Personal contact folders</span></span>                                       | <span data-ttu-id="9b6cb-212">função [delta](/graph/api/contactfolder-delta?view=graph-rest-1.0) do recurso [contactFolder](/graph/api/resources/contactfolder?view=graph-rest-1.0)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-212">[delta](/graph/api/contactfolder-delta?view=graph-rest-1.0) function of the [contactFolder](/graph/api/resources/contactfolder?view=graph-rest-1.0) resource</span></span> |
| <span data-ttu-id="9b6cb-213">Contatos pessoais em uma pasta</span><span class="sxs-lookup"><span data-stu-id="9b6cb-213">Personal contacts in a folder</span></span>                                  | <span data-ttu-id="9b6cb-214">Função [delta](/graph/api/contact-delta?view=graph-rest-1.0) do recurso [contato](/graph/api/resources/contact?view=graph-rest-1.0)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-214">[delta](/graph/api/contact-delta?view=graph-rest-1.0) function of the [contact](/graph/api/resources/contact?view=graph-rest-1.0) resource</span></span>                   |
| <span data-ttu-id="9b6cb-215">Itens do Planner\*\* (pré-visualização)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-215">Planner items\*\* (preview)</span></span>                                    | <span data-ttu-id="9b6cb-216">Função [delta](/graph/api/planneruser-list-delta) (visualização) de todos os segmentos do recurso [plannerUser](/graph/api/resources/planneruser)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-216">[delta](/graph/api/planneruser-list-delta) function (preview) of the all segment of [plannerUser](/graph/api/resources/planneruser) resource</span></span>                 |
| <span data-ttu-id="9b6cb-217">Entidades de serviço</span><span class="sxs-lookup"><span data-stu-id="9b6cb-217">Service principals</span></span>                                             | <span data-ttu-id="9b6cb-218">Função [delta](/graph/api/serviceprincipal-delta) do recurso [servicePrincipal](/graph/api/resources/serviceprincipal)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-218">[delta](/graph/api/serviceprincipal-delta) function of the [servicePrincipal](/graph/api/resources/serviceprincipal) resource</span></span>                                |
| <span data-ttu-id="9b6cb-219">Tarefas em uma lista de tarefas</span><span class="sxs-lookup"><span data-stu-id="9b6cb-219">Tasks in a task list</span></span>                                           | <span data-ttu-id="9b6cb-220">Função [delta](/graph/api/todotask-delta) do recurso [todoTask](/graph/api/resources/todotask)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-220">[delta](/graph/api/todotask-delta) function of the [todoTask](/graph/api/resources/todotask) resource</span></span>                                                        |
| <span data-ttu-id="9b6cb-221">Listas de tarefas</span><span class="sxs-lookup"><span data-stu-id="9b6cb-221">Task lists</span></span>                                                     | <span data-ttu-id="9b6cb-222">Função [delta](/graph/api/todotasklist-delta) do recurso [todoTaskList](/graph/api/resources/todotasklist)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-222">[delta](/graph/api/todotasklist-delta) function of the [todoTaskList](/graph/api/resources/todotasklist) resource</span></span>                                            |
| <span data-ttu-id="9b6cb-223">Usuários</span><span class="sxs-lookup"><span data-stu-id="9b6cb-223">Users</span></span>                                                          | <span data-ttu-id="9b6cb-224">função [delta](/graph/api/user-delta?view=graph-rest-1.0) do recurso [usuário](/graph/api/resources/user?view=graph-rest-1.0)</span><span class="sxs-lookup"><span data-stu-id="9b6cb-224">[delta](/graph/api/user-delta?view=graph-rest-1.0) function of the [user](/graph/api/resources/user?view=graph-rest-1.0) resource</span></span>                            |


> <span data-ttu-id="9b6cb-p122">\* O padrão de uso dos recursos do OneDrive é semelhante a outros recursos compatíveis com algumas diferenças secundárias de sintaxe. A consulta delta para unidades será atualizada no futuro para serem consistentes com outros tipos de recursos. Confira mais detalhes sobre a sintaxe atual em [Controlar alterações para uma unidade](/graph/api/driveitem-delta?view=graph-rest-1.0).</span><span class="sxs-lookup"><span data-stu-id="9b6cb-p122">\* The usage pattern for OneDrive resources is similar to the other supported resources with some minor syntax differences. Delta query for drives will be updated in the future to be consistent with other resource types. For more detail about the current syntax, see [Track changes for a drive](/graph/api/driveitem-delta?view=graph-rest-1.0).</span></span>

> <span data-ttu-id="9b6cb-228">\*\* O padrão de uso dos recursos do Planner é semelhante a outros recursos compatíveis, mas com algumas diferenças.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-228">\*\* The usage pattern for Planner resources is similar to other supported resources with a few differences.</span></span>  <span data-ttu-id="9b6cb-229">Para saber mais, consulte [Controlar alterações para o Planner](/graph/api/planneruser-list-delta).</span><span class="sxs-lookup"><span data-stu-id="9b6cb-229">For details, see [Track changes for Planner](/graph/api/planneruser-list-delta).</span></span>

## <a name="limitations"></a><span data-ttu-id="9b6cb-230">Limitações</span><span class="sxs-lookup"><span data-stu-id="9b6cb-230">Limitations</span></span>

### <a name="properties-stored-outside-of-the-main-data-store"></a><span data-ttu-id="9b6cb-231">Propriedades armazenadas fora do repositório de dados principal</span><span class="sxs-lookup"><span data-stu-id="9b6cb-231">Properties stored outside of the main data store</span></span>

<span data-ttu-id="9b6cb-232">Alguns recursos contêm propriedades armazenadas fora do repositório de dados principal do recurso (por exemplo, o recurso de usuário é armazenado no sistema Azure AD, enquanto algumas propriedades, como **skills**, são armazenadas no SharePoint Online).</span><span class="sxs-lookup"><span data-stu-id="9b6cb-232">Some resources contain properties that are stored outside of the main data store for the resource (for example, the user resource is mostly stored in the Azure AD system, while some properties, like **skills**, are stored in SharePoint Online).</span></span> <span data-ttu-id="9b6cb-233">Atualmente, não há suporte para essas propriedades como parte do controle de alterações; uma alteração em uma dessas propriedades não resultará em um objeto aparecendo na resposta de consulta Delta.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-233">Currently, those properties are not supported as part of change tracking; a change to one of those properties will not result in an object showing up in the delta query response.</span></span> <span data-ttu-id="9b6cb-234">Atualmente, apenas as propriedades armazenadas no repositório de dados principal disparam alterações na consulta Delta.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-234">Currently, only the properties stored in the main data store trigger changes in the delta query.</span></span>

<span data-ttu-id="9b6cb-235">Para verificar se uma propriedade pode ser usada na consulta Delta, experimente executar uma operação de `GET` regular na coleção de recursos e selecione a propriedade que você está interessado.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-235">To verify that a property can be used in delta query, try to perform a regular `GET` operation on the resource collection, and select the property you're interested in.</span></span> <span data-ttu-id="9b6cb-236">Por exemplo, você pode usar a propriedade **skills** na coleção de usuários.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-236">For example, you can try the **skills** property on the users collection.</span></span>

```msgraph-interactive
GET https://graph.microsoft.com/v1.0/users/?$select=skills
```

<span data-ttu-id="9b6cb-237">Como a propriedade **skills** é armazenada fora do Azure AD, a seguinte é a resposta.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-237">Because the **skills** property is stored outside of Azure AD, the following is the response.</span></span>

<!-- {
  "blockType": "response",
  "truncated": true,
  "@odata.type": "microsoft.graph.user",
  "isCollection": true
} -->

```http
HTTP/1.1 501 Not Implemented
Content-type: application/json

{
    "error": {
        "code": "NotImplemented",
        "message": "This operation target is not yet supported.",
        "innerError": {
            "request-id": "...",
            "date": "2019-09-20T21:47:50"
        }
    }
}
```

<span data-ttu-id="9b6cb-238">Isso informa que não há suporte para a propriedade **skills** para a consulta Delta no recurso **user**.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-238">This tells you that the **skills** property is not supported for delta query on the **user** resource.</span></span>

### <a name="navigation-properties"></a><span data-ttu-id="9b6cb-239">Propriedades de navegação</span><span class="sxs-lookup"><span data-stu-id="9b6cb-239">Navigation properties</span></span>

<span data-ttu-id="9b6cb-240">Não há suporte para propriedades de navegação.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-240">Navigation properties are not supported.</span></span> <span data-ttu-id="9b6cb-241">Por exemplo, você não pode controlar alterações na coleção de usuários que incluiriam alterações na propriedade **photo**; **photo** é uma propriedade de navegação armazenada fora da entidade do usuário, e as alterações feitas nela não fazem com que o objeto de usuário seja incluído na resposta Delta.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-241">For example, you cannot track changes to the users collection that would include changes to their **photo** property; **photo** is a navigation property stored outside of the user entity, and changes to it do not cause the user object to be included in the delta response.</span></span>

### <a name="processing-delays"></a><span data-ttu-id="9b6cb-242">Atrasos de processamento</span><span class="sxs-lookup"><span data-stu-id="9b6cb-242">Processing delays</span></span>

<span data-ttu-id="9b6cb-243">Esperar atrasos variáveis entre o tempo que uma alteração é feita em uma instância de recurso, que pode ser por meio de uma interface de aplicativo ou API, e o tempo em que a alteração controlada é refletida em uma resposta de consulta Delta.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-243">Expect varying delays between the time a change is made to a resource instance, which can be through an app interface or API, and the time the tracked change is reflected in a delta query response.</span></span>

### <a name="national-clouds"></a><span data-ttu-id="9b6cb-244">Nuvens nacionais</span><span class="sxs-lookup"><span data-stu-id="9b6cb-244">National clouds</span></span>

<span data-ttu-id="9b6cb-245">As consultas Delta estão disponíveis para os clientes hospedados na nuvem pública e o Microsoft Graph na China operado apenas pela 21Vianet.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-245">Delta queries are available for customers hosted on the public cloud and Microsoft Graph China operated by 21Vianet only.</span></span>

### <a name="replays"></a><span data-ttu-id="9b6cb-246">Repetições</span><span class="sxs-lookup"><span data-stu-id="9b6cb-246">Replays</span></span>

<span data-ttu-id="9b6cb-247">O aplicativo deve estar preparado para repetições, que ocorrem quando a mesma alteração aparece nas respostas subsequentes.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-247">Your application must be prepared for replays, which occur when the same change appears in subsequent responses.</span></span> <span data-ttu-id="9b6cb-248">Embora a consulta delta se esforce ao máximo para reduzir as repetições, elas ainda são possíveis.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-248">While delta query makes a best effort to reduce replays, they are still possible.</span></span>

### <a name="synchronization-reset"></a><span data-ttu-id="9b6cb-249">Sincronização redefinida</span><span class="sxs-lookup"><span data-stu-id="9b6cb-249">Synchronization reset</span></span>

<span data-ttu-id="9b6cb-250">A consulta delta pode retornar um código de resposta de `410 (gone)` e um cabeçalho de **Localização** contendo um URL de solicitação com um token delta vazio (igual à consulta inicial).</span><span class="sxs-lookup"><span data-stu-id="9b6cb-250">Delta query can return a response code of `410 (gone)` and a **Location** header containing a request URL with an empty delta token (same as the initial query).</span></span> <span data-ttu-id="9b6cb-251">Isso é uma indicação de que o aplicativo deve reiniciar com uma sincronização completa do locatário de destino.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-251">This is an indication that the application must restart with a full synchronization of the target tenant.</span></span> <span data-ttu-id="9b6cb-252">Isso geralmente acontece para evitar inconsistência de dados devido à manutenção interna ou migração do locatário de destino.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-252">This usually happens to prevent data inconsistency due to internal maintenance or migration of the target tenant.</span></span>

### <a name="token-duration"></a><span data-ttu-id="9b6cb-253">Duração do token</span><span class="sxs-lookup"><span data-stu-id="9b6cb-253">Token duration</span></span>

<span data-ttu-id="9b6cb-254">Os tokens Delta só são válidos para um período específico, antes que o aplicativo cliente precise executar uma sincronização total novamente.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-254">Delta tokens are only valid for a specific period before the client application needs to run a full synchronization again.</span></span> <span data-ttu-id="9b6cb-255">Para objetos de diretório (**application**, **administrativeUnit**, **directoryObject**, **directoryRole**, **group**, **orgContact**, **oauth2permissiongrant**, **servicePrincipal**, and **user**), o limite é de 7 dias.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-255">For directory objects (**application**, **administrativeUnit**, **directoryObject**, **directoryRole**, **group**, **orgContact**, **oauth2permissiongrant**, **servicePrincipal**, and **user**), the limit is 7 days.</span></span> <span data-ttu-id="9b6cb-256">Para objetos de formação educacional (**educationSchool**, **educationUser** e **educationClass**), o limite é de 7 dias.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-256">For education objects (**educationSchool**, **educationUser**, and **educationClass**), the limit is 7 days.</span></span> <span data-ttu-id="9b6cb-257">Para entidades do Outlook (**message**, **mailFolder**, **event**, **contact**, **contactFolder**, **todoTask**, and **todoTaskList**), o limite superior não é corrigido; depende do tamanho do cache de tokens do delta interno.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-257">For Outlook entities (**message**, **mailFolder**, **event**, **contact**, **contactFolder**, **todoTask**, and **todoTaskList**), the upper limit is not fixed; it's dependent on the size of the internal delta token cache.</span></span> <span data-ttu-id="9b6cb-258">Enquanto os novos tokens delta são adicionados ao cache, após a capacidade do cache ser excedida, os tokens delta mais antigos são excluídos.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-258">While new delta tokens are continuously added in the cache, after the cache capacity is exceeded, the older delta tokens are deleted.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="9b6cb-259">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="9b6cb-259">Prerequisites</span></span>

<span data-ttu-id="9b6cb-260">As mesmas [permissões](./permissions-reference.md) necessárias para ler um recurso específico também são necessárias para executar a consulta delta nesse recurso.</span><span class="sxs-lookup"><span data-stu-id="9b6cb-260">The same [permissions](./permissions-reference.md) that are required to read a specific resource are also required to perform delta query on that resource.</span></span>

## <a name="delta-query-request-examples"></a><span data-ttu-id="9b6cb-261">Exemplos de solicitação de consulta delta</span><span class="sxs-lookup"><span data-stu-id="9b6cb-261">Delta query request examples</span></span>

- [<span data-ttu-id="9b6cb-262">Obter as alterações incrementais para os eventos em um modo de exibição de calendário</span><span class="sxs-lookup"><span data-stu-id="9b6cb-262">Get incremental changes to events in a calendar view</span></span>](delta-query-events.md)
- [<span data-ttu-id="9b6cb-263">Obter as alterações incrementais para as mensagens em uma pasta</span><span class="sxs-lookup"><span data-stu-id="9b6cb-263">Get incremental changes to messages in a folder</span></span>](./delta-query-messages.md)
- [<span data-ttu-id="9b6cb-264">Obter as alterações incrementais para grupos</span><span class="sxs-lookup"><span data-stu-id="9b6cb-264">Get incremental changes to groups</span></span>](./delta-query-groups.md)
- [<span data-ttu-id="9b6cb-265">Obter as alterações incrementais para usuários</span><span class="sxs-lookup"><span data-stu-id="9b6cb-265">Get incremental changes to users</span></span>](./delta-query-users.md)
