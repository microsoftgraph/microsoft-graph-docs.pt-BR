---
title: Dicas para uso do Microsoft Graph Data Connect
description: Veja dicas de como aproveitar o Microsoft Graph Data Connect.
author: tlenig
localization_priority: Priority
ms.prod: data-connect
ms.openlocfilehash: d9a87c629a80bc94c57e77bd0f2c0b1e7438c935
ms.sourcegitcommit: d700b7e3b411e3226b5adf1f213539f05fe802e8
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/19/2021
ms.locfileid: "52547601"
---
# <a name="tips-for-using-microsoft-graph-data-connect"></a><span data-ttu-id="29291-103">Dicas para uso do Microsoft Graph Data Connect</span><span class="sxs-lookup"><span data-stu-id="29291-103">Tips for using Microsoft Graph data connect</span></span>

<span data-ttu-id="29291-104">Microsoft Graph Data Connect permite que desenvolvedores criem aplicativos que os clientes podem fornecer acesso gerenciado aos seus conjuntos de dados em escala do Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="29291-104">Microsoft Graph data connect allows developers to create applications that customers can provide managed access to their at-scale Microsoft Graph datasets.</span></span> <span data-ttu-id="29291-105">Este artigo fornece dicas para ajudar você a aproveitar os recursos do Data Connect.</span><span class="sxs-lookup"><span data-stu-id="29291-105">This article provides tips that will help you take advantage of the data connect feature.</span></span> <span data-ttu-id="29291-106">Para obter uma introdução ao Microsoft Graph Data Connect, consulte o artigo [Visão geral](data-connect-concept-overview.md).</span><span class="sxs-lookup"><span data-stu-id="29291-106">For an introduction to Microsoft Graph data connect, see the [Overview](data-connect-concept-overview.md) article.</span></span>

## <a name="is-microsoft-graph-data-connect-right-for-you"></a><span data-ttu-id="29291-107">O Microsoft Graph Data Connect é o certo para você?</span><span class="sxs-lookup"><span data-stu-id="29291-107">Is Microsoft Graph data connect right for you?</span></span>

<span data-ttu-id="29291-108">Data Connect e as APIs do Microsoft Graph fornecem acesso para os mesmos dados subjacentes, mas de formas muito diferentes.</span><span class="sxs-lookup"><span data-stu-id="29291-108">Data connect and the Microsoft Graph APIs provide access to the same underlying data but in very different ways.</span></span> <span data-ttu-id="29291-109">Data Connect foi desenvolvido para extrair grandes quantidades de dados em massa, enquanto as APIs do Microsoft Graph são mais adequadas para acessar conjuntos de dados específicos em tempo real.</span><span class="sxs-lookup"><span data-stu-id="29291-109">Data connect is designed to extract large amounts of data in bulk while the Microsoft Graph APIs are more suitable for accessing discrete sets of data in real time.</span></span> <span data-ttu-id="29291-110">Em alguns casos, ainda pode fazer sentido combiná-los.</span><span class="sxs-lookup"><span data-stu-id="29291-110">In some cases, it might even make sense to combine them.</span></span> <span data-ttu-id="29291-111">Por exemplo, convém usar o Data Connect para fazer uma extração inicial de dados de email do último ano e depois usar as APIs do Microsoft Graph para analisar emails em tempo real em diante.</span><span class="sxs-lookup"><span data-stu-id="29291-111">For example, you might want use data connect to do an initial extraction of the last year of email data, and then use the Microsoft Graph APIs to analyze emails in real time moving forward.</span></span> <span data-ttu-id="29291-112">Data Connect e as APIs do Microsoft Graph são ferramentas diferentes para tarefas diferentes.</span><span class="sxs-lookup"><span data-stu-id="29291-112">Data connect and the Microsoft Graph APIs are different tools for different jobs.</span></span> <span data-ttu-id="29291-113">É importante pensar sobre o qual método de acesso melhor se encaixa em seu cenário.</span><span class="sxs-lookup"><span data-stu-id="29291-113">It's important to think about which access method best fits your scenario.</span></span>

## <a name="expect-an-initial-overhead"></a><span data-ttu-id="29291-114">Espere uma sobrecarga inicial</span><span class="sxs-lookup"><span data-stu-id="29291-114">Expect an initial overhead</span></span>

<span data-ttu-id="29291-115">Como o Data Connect é projetado para extrair grandes quantidades de dados em massa, alguma sobrecarga é incorrida antes que os dados possam ser extraídos.</span><span class="sxs-lookup"><span data-stu-id="29291-115">Because data connect is designed to extract large amounts of data in bulk, some overhead is incurred before the data can be extracted.</span></span> <span data-ttu-id="29291-116">Essa sobrecarga é de aproximadamente 45 minutos, ou seja, todos os pipelines levarão no mínimo esse tempo, independentemente do tamanho dos dados.</span><span class="sxs-lookup"><span data-stu-id="29291-116">This overhead is around 45 minutes, meaning all pipelines will take at least that long regardless of the data size.</span></span> <span data-ttu-id="29291-117">Isso pode ser um custo insignificante para grandes quantidades de dados, mas se for inaceitável para seu cenário, as APIs do Microsoft Graph podem fornecer uma melhor abordagem.</span><span class="sxs-lookup"><span data-stu-id="29291-117">This might be a negligible cost for large amounts of data, but if this time is unacceptable for your scenario, the Microsoft Graph APIs might provide a better approach.</span></span>

## <a name="data-must-stay-within-the-organizations-subscription"></a><span data-ttu-id="29291-118">Os dados devem ficar dentro da assinatura da organização</span><span class="sxs-lookup"><span data-stu-id="29291-118">Data must stay within the organization's subscription</span></span>

<span data-ttu-id="29291-119">Os pipelines do Data Connect são organizados pelo Azure Data Factory, um serviço de integração de dados executado em uma assinatura do Azure.</span><span class="sxs-lookup"><span data-stu-id="29291-119">Data connect pipelines are orchestrated by Azure Data Factory, a data integration service that runs in an Azure subscription.</span></span> <span data-ttu-id="29291-120">A assinatura do Azure está [associada a exatamente um locatário do Microsoft 365](/azure/active-directory/fundamentals/active-directory-how-subscriptions-associated-directory).</span><span class="sxs-lookup"><span data-stu-id="29291-120">The Azure subscription is [associated with exactly one Microsoft 365 tenant](/azure/active-directory/fundamentals/active-directory-how-subscriptions-associated-directory).</span></span> <span data-ttu-id="29291-121">Dessa forma, os dados devem ter o fluxo associado inicialmente a uma assinatura do Azure.</span><span class="sxs-lookup"><span data-stu-id="29291-121">This way, the data must initially flow to an associated Azure subscription.</span></span> <span data-ttu-id="29291-122">Depois de mais minimalização e agregação, os dados podem ser usados em outro lugar.</span><span class="sxs-lookup"><span data-stu-id="29291-122">After further minimalization and aggregation, the data can be used elsewhere.</span></span>

<span data-ttu-id="29291-123">Se você quiser desenvolver um aplicativo para outras pessoas usarem para extrair os dados do Microsoft 365, você pode compactar o aplicativo como um [aplicativo gerenciado do Azure](/azure/managed-applications/overview) e publicar no Azure Marketplace.</span><span class="sxs-lookup"><span data-stu-id="29291-123">If you want to build an app for others to use to extract their Microsoft 365 data, you can package the app as an [Azure managed application](/azure/managed-applications/overview) and publish it to the Azure Marketplace.</span></span> <span data-ttu-id="29291-124">Em seguida, alguém pode implantar o aplicativo em sua própria assinatura do Azure, e o aplicativo pode acessar dados em seu locatário.</span><span class="sxs-lookup"><span data-stu-id="29291-124">Then someone can deploy your app into their own Azure subscription, and the app can access data in their tenant.</span></span> 

## <a name="use-of-service-principals"></a><span data-ttu-id="29291-125">Uso de entidades de serviço</span><span class="sxs-lookup"><span data-stu-id="29291-125">Use of service principals</span></span>

<span data-ttu-id="29291-126">Ao criar o pipeline do Data Factory, você terá que fornecer uma entidade de serviço para o serviço vinculado do Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="29291-126">When creating the Data Factory pipeline, you will have to provide a service principal to the Microsoft 365 linked service.</span></span> <span data-ttu-id="29291-127">No Azure, uma entidade de serviço é uma identidade de segurança que representa um aplicativo ou serviço (e não um usuário).</span><span class="sxs-lookup"><span data-stu-id="29291-127">In Azure, a service principal is a security identity that represents an application/service (as opposed to a user).</span></span> <span data-ttu-id="29291-128">A Conexão de Dados usa essa entidade de serviço como sua identidade ao receber acesso autorizado aos seus dados do Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="29291-128">Data connect uses this service principal as its identity when getting authorized access to your Microsoft 365 data.</span></span>
<span data-ttu-id="29291-129">Se você criar um Aplicativo Gerenciado do Azure para que outras pessoas usem em seus locatários, você ainda irá fornecer uma entidade de serviço para uso do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="29291-129">If you create an Azure Managed Application for others to use in their tenants, you'll still provide a service principal for the app to use.</span></span> <span data-ttu-id="29291-130">A entidade de serviço ficará armazenado em seu locatário (do fornecedor).</span><span class="sxs-lookup"><span data-stu-id="29291-130">This service principal will exist in your (the publisher's) tenant.</span></span> <span data-ttu-id="29291-131">No entanto, se o aplicativo precisa de outras entidades de serviço, seu cliente (instalador) irá criá-las em seu próprio locatário.</span><span class="sxs-lookup"><span data-stu-id="29291-131">However, if the app needs other service principals, your customer (the installer) will create them in their own tenant.</span></span> <span data-ttu-id="29291-132">Por exemplo, seu pipeline do Data Factory provavelmente precisará de acesso a um recurso de armazenamento no Azure.</span><span class="sxs-lookup"><span data-stu-id="29291-132">For example, your Data Factory pipeline will likely need access to a storage resource in Azure.</span></span> <span data-ttu-id="29291-133">O cliente criaria a entidade de serviço com permissões para a conta de armazenamento para uso do pipeline.</span><span class="sxs-lookup"><span data-stu-id="29291-133">The customer would create the service principal with permissions to the storage account for the pipeline to use.</span></span>

## <a name="check-for-pending-privileged-access-management-requests"></a><span data-ttu-id="29291-134">Procure por solicitações pendentes do Privileged Access Management</span><span class="sxs-lookup"><span data-stu-id="29291-134">Check for pending Privileged Access Management requests</span></span>

<span data-ttu-id="29291-135">Antes que o Data Connect possa copiar seus dados, um administrador deve aprovar uma solicitação de Privileged Access Management (PAM).</span><span class="sxs-lookup"><span data-stu-id="29291-135">Before data connect can copy your data, an administrator must approve a Privileged Access Management (PAM) request.</span></span> <span data-ttu-id="29291-136">PAM é o mecanismo usado para autorizar seu acesso a dados de pipeline aos dados no Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="29291-136">PAM is the mechanism used to authorize your data pipeline access to the data in Microsoft 365.</span></span> <span data-ttu-id="29291-137">Na primeira vez que acionar um pipeline, irá esperar a aprovação da solicitação de acesso de um administrador do Microsoft 365 (ou representante indicado).</span><span class="sxs-lookup"><span data-stu-id="29291-137">The first time you trigger a pipeline, it will wait on a Microsoft 365 administrator (or appointed delegate) to approve the access request.</span></span> <span data-ttu-id="29291-138">Embora o status do pipeline mostra **Em andamento**, a atividade de cópia subjacente terá o status **ConsentimentoPendente** até que o acesso seja aprovado, conforme mostrado na captura de tela a seguir.</span><span class="sxs-lookup"><span data-stu-id="29291-138">Although the pipeline status shows **In progress**, the underlying copy activity will have a status of **ConsentPending** until approval is granted, as shown in the following screenshot.</span></span>

![Captura de tela do painel de status da execução de pipeline com um status ConsentimentoPendente](images/data-connect-tips.png)

<span data-ttu-id="29291-140">Durante o desenvolvimento, é uma boa ideia para garantir que a execução do seu pipeline não fique preso em **ConsentimentoPendente**, especialmente após alterar seu pipeline.</span><span class="sxs-lookup"><span data-stu-id="29291-140">During development, it's a good idea to make sure your pipeline runs aren't stuck on **ConsentPending**, especially after you make a change to your pipeline.</span></span> <span data-ttu-id="29291-141">Por exemplo, se você inserir um campo adicional no esquema, a próxima execução de pipeline emitirá uma nova solicitação de PAM que precisa ser aprovada.</span><span class="sxs-lookup"><span data-stu-id="29291-141">For example, if you add an additional field to the schema, the next pipeline run will issue a new PAM request that has to be approved.</span></span> <span data-ttu-id="29291-142">Não desperdice tempo esperando um pipeline que aguarda sua aprovação.</span><span class="sxs-lookup"><span data-stu-id="29291-142">Don't waste time waiting on a pipeline that's waiting for your approval.</span></span>

## <a name="approve-pam-requests-via-microsoft-365-admin-portal"></a><span data-ttu-id="29291-143">Aprove solicitações PAM através do portal de administração do Microsoft 365</span><span class="sxs-lookup"><span data-stu-id="29291-143">Approve PAM requests via Microsoft 365 admin portal</span></span>

<span data-ttu-id="29291-144">A documentação do Data Connect mostra como usar o PowerShell e UX do PAM para aprovar solicitações PAM.</span><span class="sxs-lookup"><span data-stu-id="29291-144">The data connect documentation shows you how to use PowerShell and the PAM UX to approve PAM requests.</span></span> <span data-ttu-id="29291-145">Para aprovar usando a UX do PAM, acesse a interface PAM no [portal de administração do Microsoft 365](https://admin.microsoft.com/Adminportal/Home?source=applauncher#/Settings/PrivilegedAccess).</span><span class="sxs-lookup"><span data-stu-id="29291-145">To approve using the PAM UX, visit the PAM interface in the [Microsoft 365 admin portal](https://admin.microsoft.com/Adminportal/Home?source=applauncher#/Settings/PrivilegedAccess).</span></span> <span data-ttu-id="29291-146">O portal fornece uma maneira simples e fácil para exibir, aprovar, negar, revogar solicitações PAM.</span><span class="sxs-lookup"><span data-stu-id="29291-146">The portal provides an easy and user-friendly way to view and approve/deny/revoke PAM requests.</span></span> <span data-ttu-id="29291-147">Você encontra um link para ele no suplemento do Microsoft Graph Data Connect em **Configurações** > **Serviços e Suplementos** > **Microsoft Graph Data Connect**.</span><span class="sxs-lookup"><span data-stu-id="29291-147">You can find a link to it in the Microsoft Graph data connect add-in under **Settings** > **Services & Add-ins** > **Microsoft Graph data connect**.</span></span>

## <a name="use-a-second-user-to-approve-pam-requests"></a><span data-ttu-id="29291-148">Usar um segundo usuário para aprovar as solicitações PAM</span><span class="sxs-lookup"><span data-stu-id="29291-148">Use a second user to approve PAM requests</span></span>

<span data-ttu-id="29291-149">Quando você executa um pipeline e aciona uma solicitação PAM, a solicitação é anexada à conta de usuário que é o proprietário de entidade de serviço usada pelo pipeline.</span><span class="sxs-lookup"><span data-stu-id="29291-149">When you run a pipeline and trigger a PAM request, the request is attached to your user account that owns the service principal used by the pipeline.</span></span> <span data-ttu-id="29291-150">Mas mesmo se essa conta for parte do grupo aprovador que você definiu, você não pode usá-la para aprovar a solicitação PAM porque autoaprovações não são permitidas.</span><span class="sxs-lookup"><span data-stu-id="29291-150">But even if this account is part of the approver group you set up, you can't use it to approve the PAM request because self-approvals are not allowed.</span></span> <span data-ttu-id="29291-151">Se você tentar, receberá uma mensagem de erro no portal PAM: "Solicitante e aprovador são iguais.</span><span class="sxs-lookup"><span data-stu-id="29291-151">If you try, you'll get an error message in the PAM portal: "Requestor and approver are the same.</span></span> <span data-ttu-id="29291-152">Não é permitida autoaprovação.”</span><span class="sxs-lookup"><span data-stu-id="29291-152">Self-approval is not allowed."</span></span> <span data-ttu-id="29291-153">Para o desenvolvimento, convém ter uma segunda conta, além da de administrador que aprova as solicitações.</span><span class="sxs-lookup"><span data-stu-id="29291-153">For development, you'll want to have a second account in addition to the admin who approves requests.</span></span> <span data-ttu-id="29291-154">O solicitante e o aprovador devem ter contas ativas do Exchange Online.</span><span class="sxs-lookup"><span data-stu-id="29291-154">Both the submitter and the approver must have active Exchange Online accounts.</span></span>

## <a name="deduplicate-emails-when-needed"></a><span data-ttu-id="29291-155">Elimine a duplicação de emails quando necessário</span><span class="sxs-lookup"><span data-stu-id="29291-155">Deduplicate emails when needed</span></span>

<span data-ttu-id="29291-156">Quando você extrair emails do conjunto de dados `Message`, geralmente haverá vários objetos JSON para o mesmo email.</span><span class="sxs-lookup"><span data-stu-id="29291-156">When you extract emails from the `Message` dataset, there will often be multiple JSON objects for the same email.</span></span> <span data-ttu-id="29291-157">Essas duplicatas existem quando um email é enviado para várias pessoas, há uma cópia do email na caixa de correio de cada destinatário.</span><span class="sxs-lookup"><span data-stu-id="29291-157">These duplicates exist because when an email is sent to multiple people, there is a copy of the email in every recipient's mailbox.</span></span> <span data-ttu-id="29291-158">Como o conjunto de dados é extraído de cada caixa de correio, haverá todas as cópias entre os usuários.</span><span class="sxs-lookup"><span data-stu-id="29291-158">Because the dataset is extracted from every mailbox, it will contain all copies across users.</span></span> <span data-ttu-id="29291-159">Em alguns cenários, talvez seja necessário manter cada cópia, mas em outros talvez você queira remover as duplicatas.</span><span class="sxs-lookup"><span data-stu-id="29291-159">In some scenarios, it might be necessary to keep every copy but in others, you may want to remove the duplicates.</span></span>
<span data-ttu-id="29291-160">Você pode eliminar as duplicatas dos objetos JSON exportados baseados em `internetMessageId` das mensagens: duas mensagens com o mesmo `internetMessageId` são cópias duplicadas da mesma instância.</span><span class="sxs-lookup"><span data-stu-id="29291-160">You can deduplicate the exported JSON objects based on the `internetMessageId` of the messages: Two messages with the same `internetMessageId` are duplicate copies of the same instance.</span></span> <span data-ttu-id="29291-161">Como as duplicatas podem existir em diferentes blobs, você deve eliminar as duplicatas em todos os blobs em vez de fazer isso em cada blob separadamente.</span><span class="sxs-lookup"><span data-stu-id="29291-161">Because the duplicates can exist in different blobs, you must deduplicate across all blobs rather than deduplicating in each blob separately.</span></span>

## <a name="use-puser-field-to-determine-the-relevant-user"></a><span data-ttu-id="29291-162">Use o campo puser para determinar o usuário relevante</span><span class="sxs-lookup"><span data-stu-id="29291-162">Use puser field to determine the relevant user</span></span>

<span data-ttu-id="29291-163">Os dados extraídos incluem algumas propriedades meta que não existem se forem usadas as APIs correspondentes do Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="29291-163">The extracted data includes some meta properties that don't exist when using the corresponding Microsoft Graph APIs.</span></span> <span data-ttu-id="29291-164">Especificamente, o campo `puser` pode ser útil para determinar de quais usuários os dados foram extraídos.</span><span class="sxs-lookup"><span data-stu-id="29291-164">Specifically, the `puser` field can be useful for determining which user the data was extracted from.</span></span> <span data-ttu-id="29291-165">No cenário em que você tem duas cópias do mesmo email em caixas de correio diferentes, você pode usar o campo `puser` para determinar as caixas de correio de origem das cópias.</span><span class="sxs-lookup"><span data-stu-id="29291-165">In the scenario where you have two copies of the same email in different mailboxes, you can use the `puser` field to determine which copy came from which mailbox.</span></span>
<span data-ttu-id="29291-166">O campo `puser` também é útil para conjuntos de dados, como o conjunto de dados `Manager`.</span><span class="sxs-lookup"><span data-stu-id="29291-166">The `puser` field is also useful for datasets such as the `Manager` dataset.</span></span> <span data-ttu-id="29291-167">JSON exportado inclui informações sobre um gerenciador, mas isso é útil apenas se você souber o que gerenciam.</span><span class="sxs-lookup"><span data-stu-id="29291-167">The exported JSON will contain information about a manager, but this is only useful if you know whose manager they are.</span></span> <span data-ttu-id="29291-168">O campo `puser` indicará qual gerenciador corresponde ao objeto JSON.</span><span class="sxs-lookup"><span data-stu-id="29291-168">The `puser` field will tell you whose manager that JSON object corresponds to.</span></span>

## <a name="next-steps"></a><span data-ttu-id="29291-169">Próximos passos</span><span class="sxs-lookup"><span data-stu-id="29291-169">Next Steps</span></span>

<span data-ttu-id="29291-170">Entre em contato no [fórum de ideias de Plataforma de Desenvolvedor Microsoft 365](https://techcommunity.microsoft.com/t5/microsoft-365-developer-platform/idb-p/Microsoft365DeveloperPlatform/label-name/Microsoft%20Graph) para solicitações de recursos.</span><span class="sxs-lookup"><span data-stu-id="29291-170">Reach out on the [Microsoft 365 Developer Platform ideas forum](https://techcommunity.microsoft.com/t5/microsoft-365-developer-platform/idb-p/Microsoft365DeveloperPlatform/label-name/Microsoft%20Graph) for feature requests.</span></span>